#C_USER
C_USER_001=SELECT * FROM C_USER WHERE USER = ? AND PSWD = ?

#C_LOGIN_STATUS
C_LOGIN_STATUS_001=SELECT * FROM C_LOGIN_STATUS WHERE USER = ?
C_LOGIN_STATUS_002=INSERT INTO C_LOGIN_STATUS (USER, SID) VALUES (?, ?)
C_LOGIN_STATUS_003=UPDATE C_LOGIN_STATUS SET SID = ? WHERE USER = ?
C_LOGIN_STATUS_004=DELETE FROM C_LOGIN_STATUS WHERE USER = ?


########################################
# MASETR
########################################

#M_BASIC
M_BASIC_001=SELECT * FROM M_BASIC
M_BASIC_002=UPDATE M_BASIC SET NAME = ?, POSTCODE1 = ?, POSTCODE2 = ?, ADDR1 = ?, ADDR2 = ?, TEL = ?, FAX = ?, BANK = ?, BRANCH = ?, ACCOUNTNO = ?, ACCOUNTNAME = ?, KISYUYEAR = ?, KISYUMONTH = ?, KIMATSUYEAR = ?, KIMATSUMONTH = ?, KIMATSUDATE = ?, KESSAN = ?, TAX = ?, TAXVAL = ?, CALC = ?, CALCHASU = ? WHERE CODE =? AND UPDDATE = ?

#M_STAFF
M_STAFF_001=SELECT * FROM M_STAFF ORDER BY CODE
M_STAFF_002=DELETE FROM M_STAFF WHERE CODE IN
M_STAFF_003=UPDATE M_STAFF SET SEI = ?, NAME = ?, SEIKANA = ?, NAMEKANA = ?, BUSYO = ? WHERE CODE = ? AND UPDDATE = ?
M_STAFF_004=INSERT INTO M_STAFF (CODE, SEI, NAME, SEIKANA, NAMEKANA, BUSYO) VALUES (?, ?, ?, ?, ?, ?)
M_STAFF_005=SELECT * FROM M_STAFF WHERE CODE = ?

#M_ITEM
M_ITEM_001=SELECT * FROM M_ITEM ORDER BY CODE
M_ITEM_002=UPDATE M_ITEM SET NAME = ?, KANA = ?, KIKAKU = ?, CLASSCODE = ?, STOCK = ?, PROPERSTOCK = ?, KISYUSTOCK = ?, KICYUSTOCKUPDOWN = ?, UNIT = ?, PRICE = ?, KISYUPRICE = ?, STANDARDPRICE = ?, SELLINGPRICE2 = ?, SELLINGPRICE3 = ?, SELLINGPRICE4 = ?, SELLINGPRICE5 = ? WHERE CODE = ? AND UPDDATE = ?
M_ITEM_003=INSERT INTO M_ITEM (CODE, NAME, KANA, KIKAKU, CLASSCODE, STOCK, PROPERSTOCK, KISYUSTOCK, KICYUSTOCKUPDOWN, UNIT, PRICE, KISYUPRICE, STANDARDPRICE, SELLINGPRICE2, SELLINGPRICE3, SELLINGPRICE4, SELLINGPRICE5) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
M_ITEM_004=SELECT * FROM M_ITEM WHERE CODE = ?
M_ITEM_005=DELETE FROM M_ITEM WHERE CODE IN
M_ITEM_006=UPDATE M_ITEM SET STOCK = ? WHERE CODE = ?

#M_ITEM_CLASS
M_ITEM_CLASS_001=SELECT * FROM M_ITEM_CLASS ORDER BY CODE
M_ITEM_CLASS_002=SELECT * FROM M_ITEM_CLASS WHERE CODE = ?
M_ITEM_CLASS_003=INSERT INTO M_ITEM_CLASS (CODE, NAME, KANA) VALUES (?, ?, ?)
M_ITEM_CLASS_004=UPDATE M_ITEM_CLASS SET NAME = ?, KANA = ? WHERE CODE = ? AND UPDDATE = ?
M_ITEM_CLASS_005=DELETE FROM M_ITEM_CLASS WHERE CODE IN

#M_CUSTOMER
M_CUSTOMER_001=SELECT * FROM M_CUSTOMER ORDER BY CODE
M_CUSTOMER_002=SELECT * FROM M_CUSTOMER WHERE CODE = ?
M_CUSTOMER_003=INSERT INTO M_CUSTOMER (CODE, NAME, KANA, CLASSCODE, ADDR1, ADDR2, POSTCODE1, POSTCODE2, TEL, FAX, CUSTOMERSTAFFSEI, CUSTOMERSTAFFNAME, KEISYO, BUSYO, DEALDIVISION, KESSAIDIVISION, SALEPRICEDIVISION, KISYUBALANCE, SHIMEBIMONTHLY, SHIMEBIKESSAI, KESSAIMONTHLY, STAFFCODE) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
M_CUSTOMER_004=UPDATE M_CUSTOMER SET NAME = ?, KANA = ?, CLASSCODE = ?, ADDR1 = ?, ADDR2 = ?, POSTCODE1 = ?, POSTCODE2 = ?, TEL = ?, FAX = ?, CUSTOMERSTAFFSEI = ?, CUSTOMERSTAFFNAME = ?, KEISYO = ?, BUSYO = ?, DEALDIVISION = ?, KESSAIDIVISION = ?, SALEPRICEDIVISION = ?, KISYUBALANCE = ?, SHIMEBIMONTHLY = ?, SHIMEBIKESSAI = ?, KESSAIMONTHLY = ?, STAFFCODE = ? WHERE CODE = ? AND UPDDATE = ?
M_CUSTOMER_005=DELETE FROM M_CUSTOMER WHERE CODE IN

#M_CUSTOMER_CLASS
M_CUSTOMER_CLASS_001=SELECT * FROM M_CUSTOMER_CLASS ORDER BY CODE
M_CUSTOMER_CLASS_002=SELECT * FROM M_CUSTOMER_CLASS WHERE CODE = ?
M_CUSTOMER_CLASS_003=INSERT INTO M_CUSTOMER_CLASS (CODE, NAME, KANA) VALUES (?, ?, ?)
M_CUSTOMER_CLASS_004=UPDATE M_CUSTOMER_CLASS SET NAME = ?, KANA = ? WHERE CODE = ? AND UPDDATE = ?
M_CUSTOMER_CLASS_005=DELETE FROM M_CUSTOMER_CLASS WHERE CODE IN

#M_SUPPLIER
M_SUPPLIER_001=SELECT * FROM M_SUPPLIER ORDER BY CODE
M_SUPPLIER_002=SELECT * FROM M_SUPPLIER WHERE CODE = ?
M_SUPPLIER_003=INSERT INTO M_SUPPLIER (CODE, NAME, KANA, CLASSCODE, ADDR1, ADDR2, POSTCODE1, POSTCODE2, TEL, FAX, SUPPLIERSTAFFSEI, SUPPLIERSTAFFNAME, KEISYO, BUSYO, DEALDIVISION, KESSAIDIVISION, KISYUBALANCE, SHIMEBIMONTHLY, SHIMEBIKESSAI, KESSAIMONTHLY, STAFFCODE, TAX, CALC, CALCHASU) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
M_SUPPLIER_004=UPDATE M_SUPPLIER SET NAME = ?, KANA = ?, CLASSCODE = ?, ADDR1 = ?, ADDR2 = ?, POSTCODE1 = ?, POSTCODE2 = ?, TEL = ?, FAX = ?, SUPPLIERSTAFFSEI = ?, SUPPLIERSTAFFNAME = ?, KEISYO = ?, BUSYO = ?, DEALDIVISION = ?, KESSAIDIVISION = ?, KISYUBALANCE = ?, SHIMEBIMONTHLY = ?, SHIMEBIKESSAI = ?, KESSAIMONTHLY = ?, STAFFCODE = ?, TAX = ?, CALC = ?, CALCHASU = ? WHERE CODE = ? AND UPDDATE = ?
M_SUPPLIER_005=DELETE FROM M_SUPPLIER WHERE CODE IN

#M_SUPPLIER_CLASS
M_SUPPLIER_CLASS_001=SELECT * FROM M_SUPPLIER_CLASS ORDER BY CODE
M_SUPPLIER_CLASS_002=SELECT * FROM M_SUPPLIER_CLASS WHERE CODE = ?
M_SUPPLIER_CLASS_003=INSERT INTO M_SUPPLIER_CLASS (CODE, NAME, KANA) VALUES (?, ?, ?)
M_SUPPLIER_CLASS_004=UPDATE M_SUPPLIER_CLASS SET NAME = ?, KANA = ? WHERE CODE = ? AND UPDDATE = ?
M_SUPPLIER_CLASS_005=DELETE FROM M_SUPPLIER_CLASS WHERE CODE IN


########################################
# VOUCHER
########################################

#T_QUOTATION
T_QUOTATION_001=SELECT MAX(voucherNo) AS voucherNo FROM T_QUOTATION
T_QUOTATION_002=SELECT voucherNo FROM T_QUOTATION WHERE voucherNo = ?
T_QUOTATION_003=INSERT INTO T_QUOTATION (voucherNo, voucherDate, discount, quotationName, paymentLimit, paymentPlace, paymentCondition, expirationDate, memo) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)
T_QUOTATION_004=UPDATE T_QUOTATION SET voucherDate = ?, discount = ?, quotationName = ?, paymentLimit = ?, paymentPlace = ?, paymentCondition = ?, expirationDate = ?, memo = ? WHERE voucherNo = ?
T_QUOTATION_005=DELETE FROM T_QUOTATION WHERE voucherNo IN

#T_QUOTATION_DEAL
T_QUOTATION_DEAL_001=INSERT INTO T_QUOTATION_DEAL (voucherNo,dealKind,dealCode) VALUES (?,?,?)
T_QUOTATION_DEAL_002=UPDATE T_QUOTATION_DEAL SET dealKind = ?,dealCode = ? WHERE voucherNo = ?
T_QUOTATION_DEAL_003=DELETE FROM T_QUOTATION_DEAL WHERE voucherNo IN

#T_QUOTATION_DETAILS
T_QUOTATION_DETAILS_001=INSERT INTO T_QUOTATION_DETAILS(voucherNo,seq,itemCode,itemUnitPrice,itemCount,itemMemo) VALUES (?, ?, ?, ?, ?, ?)
T_QUOTATION_DETAILS_002=DELETE FROM T_QUOTATION_DETAILS WHERE voucherNo IN

#T_ORDER
T_ORDER_001=SELECT MAX(voucherNo) AS voucherNo FROM T_ORDER
T_ORDER_002=SELECT voucherNo FROM T_ORDER WHERE voucherNo = ?
T_ORDER_003=INSERT INTO T_ORDER (voucherNo, voucherDate, discount, orderName, paymentLimit, paymentPlace, paymentCondition, expirationDate, memo) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)
T_ORDER_004=UPDATE T_ORDER SET voucherDate = ?, discount = ?, orderName = ?, paymentLimit = ?, paymentPlace = ?, paymentCondition = ?, expirationDate = ?, memo = ? WHERE voucherNo = ?
T_ORDER_005=DELETE FROM T_ORDER WHERE voucherNo IN

#T_ORDER_DEAL
T_ORDER_DEAL_001=INSERT INTO T_ORDER_DEAL (voucherNo,dealKind,dealCode) VALUES (?,?,?)
T_ORDER_DEAL_002=UPDATE T_ORDER_DEAL SET dealKind = ?,dealCode = ? WHERE voucherNo = ?
T_ORDER_DEAL_003=DELETE FROM T_ORDER_DEAL WHERE voucherNo IN

#T_ORDER_DETAILS
T_ORDER_DETAILS_001=INSERT INTO T_ORDER_DETAILS(voucherNo,seq,itemCode,itemUnitPrice,itemCount,itemMemo) VALUES (?, ?, ?, ?, ?, ?)
T_ORDER_DETAILS_002=DELETE FROM T_ORDER_DETAILS WHERE voucherNo IN

#T_SALES
T_SALES_001=SELECT MAX(voucherNo) AS voucherNo FROM T_SALES
T_SALES_002=SELECT voucherNo FROM T_SALES WHERE voucherNo = ?
T_SALES_003=INSERT INTO T_SALES (voucherNo, voucherDate, discount, etc1, etc2, receiptNo, proviso, receiptDate, memo) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)
T_SALES_004=UPDATE T_SALES SET voucherDate = ?, discount = ?, etc1 = ?, etc2 = ?, receiptNo = ?, proviso = ?, receiptDate = ?, memo = ? WHERE voucherNo = ?
T_SALES_005=DELETE FROM T_SALES WHERE voucherNo IN

#T_SALES_DEAL
T_SALES_DEAL_001=INSERT INTO T_SALES_DEAL (voucherNo,dealKind,dealCode) VALUES (?,?,?)
T_SALES_DEAL_002=UPDATE T_SALES_DEAL SET dealKind = ?,dealCode = ? WHERE voucherNo = ?
T_SALES_DEAL_003=DELETE FROM T_SALES_DEAL WHERE voucherNo IN

#T_SALES_DETAILS
T_SALES_DETAILS_001=INSERT INTO T_SALES_DETAILS(voucherNo,seq,itemCode,itemUnitPrice,itemCount,itemMemo) VALUES (?, ?, ?, ?, ?, ?)
T_SALES_DETAILS_002=DELETE FROM T_SALES_DETAILS WHERE voucherNo IN

#T_PURCHASE
T_PURCHASE_001=SELECT MAX(voucherNo) AS voucherNo FROM T_PURCHASE
T_PURCHASE_002=SELECT voucherNo FROM T_PURCHASE WHERE voucherNo = ?
T_PURCHASE_003=INSERT INTO T_PURCHASE (voucherNo, voucherDate, discount, etc1, etc2, memo) VALUES (?, ?, ?, ?, ?, ?)
T_PURCHASE_004=UPDATE T_PURCHASE SET voucherDate = ?, discount = ?, etc1 = ?, etc2 = ?, memo = ? WHERE voucherNo = ?
T_PURCHASE_005=DELETE FROM T_PURCHASE WHERE voucherNo IN

#T_PURCHASE_DEAL
T_PURCHASE_DEAL_001=INSERT INTO T_PURCHASE_DEAL (voucherNo,dealKind,dealCode) VALUES (?,?,?)
T_PURCHASE_DEAL_002=UPDATE T_PURCHASE_DEAL SET dealKind = ?,dealCode = ? WHERE voucherNo = ?
T_PURCHASE_DEAL_003=DELETE FROM T_PURCHASE_DEAL WHERE voucherNo IN

#T_PURCHASE_DETAILS
T_PURCHASE_DETAILS_001=INSERT INTO T_PURCHASE_DETAILS(voucherNo,seq,itemCode,itemUnitPrice,itemCount,itemMemo) VALUES (?, ?, ?, ?, ?, ?)
T_PURCHASE_DETAILS_002=DELETE FROM T_PURCHASE_DETAILS WHERE voucherNo IN

#T_BILL
T_BILL_001=SELECT MAX(voucherNo) AS voucherNo FROM T_BILL
T_BILL_002=SELECT voucherNo FROM T_BILL WHERE voucherNo = ?
T_BILL_003=INSERT INTO T_BILL (voucherNo, voucherDate, discount, memo) VALUES (?, ?, ?, ?)
T_BILL_004=UPDATE T_BILL SET voucherDate = ?, discount = ?, memo = ? WHERE voucherNo = ?
T_BILL_005=DELETE FROM T_BILL WHERE voucherNo IN

#T_BILL_DEAL
T_BILL_DEAL_001=INSERT INTO T_BILL_DEAL (voucherNo,dealKind,dealCode) VALUES (?,?,?)
T_BILL_DEAL_002=UPDATE T_BILL_DEAL SET dealKind = ?,dealCode = ? WHERE voucherNo = ?
T_BILL_DEAL_003=DELETE FROM T_BILL_DEAL WHERE voucherNo IN

#T_BILL_DETAILS
T_BILL_DETAILS_001=INSERT INTO T_BILL_DETAILS(voucherNo,seq,salesNo,salesSeq,salesDate,itemCode,itemName,itemKikaku,itemCount,itemUnit,itemUnitPrice,itemMemo,itemPurchasePrice) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
T_BILL_DETAILS_002=DELETE FROM T_BILL_DETAILS WHERE voucherNo IN

#VOUCHER
VOUCHER_001=SELECT Q.voucherNo AS voucherNo, voucherDate, quotationName AS voucherName, paymentLimit, paymentPlace, paymentCondition, expirationDate, memo, discount, dealKind, dealName, dealCode, dealClassCode, dealClassName, dealStaffSei, dealStaffName, dealStaffKeisyo, dealStaffBusyo, dealTel, dealPostCode1, dealPostCode2, dealAddr1, dealAddr2, shimebiMonthly, kessaiMonthly, shimebiKessai, dealDivision, priceDivision, staffSei, staffName, staffCode, staffBusyo, seq, itemName, itemCode, itemKikaku, itemCount, itemUnit, itemUnitPrice, itemMemo, itemPurchasePrice FROM T_QUOTATION Q LEFT JOIN V_QUOTATION_DEAL QD ON Q.voucherNo = QD.voucherNo LEFT JOIN V_QUOTATION_DETAILS QI ON Q.voucherNo = QI.voucherNo ORDER BY Q.voucherNo, seq
VOUCHER_002=SELECT Q.voucherNo AS voucherNo, voucherDate, orderName AS voucherName, paymentLimit, paymentPlace, paymentCondition, expirationDate, memo, discount, dealKind, dealName, dealCode, dealClassCode, dealClassName, dealStaffSei, dealStaffName, dealStaffKeisyo, dealStaffBusyo, dealTel, dealPostCode1, dealPostCode2, dealAddr1, dealAddr2, shimebiMonthly, kessaiMonthly, shimebiKessai, dealDivision, tax, calc, calcHasu, staffSei, staffName, staffCode, staffBusyo, seq, itemName, itemCode, itemKikaku, itemCount, itemUnit, itemUnitPrice, itemMemo, itemPurchasePrice FROM T_ORDER Q LEFT JOIN V_ORDER_DEAL QD ON Q.voucherNo = QD.voucherNo LEFT JOIN V_ORDER_DETAILS QI ON Q.voucherNo = QI.voucherNo ORDER BY Q.voucherNo, seq
VOUCHER_003=SELECT Q.voucherNo AS voucherNo, voucherDate, etc1, etc2, receiptNo, proviso, receiptDate, memo, discount, dealKind, dealName, dealCode, dealClassCode, dealClassName, dealStaffSei, dealStaffName, dealStaffKeisyo, dealStaffBusyo, dealTel, dealPostCode1, dealPostCode2, dealAddr1, dealAddr2, shimebiMonthly, kessaiMonthly, shimebiKessai, dealDivision, priceDivision, staffSei, staffName, staffCode, staffBusyo, seq, itemName, itemCode, itemKikaku, itemCount, itemUnit, itemUnitPrice, itemMemo, itemPurchasePrice FROM T_SALES Q LEFT JOIN V_SALES_DEAL QD ON Q.voucherNo = QD.voucherNo LEFT JOIN V_SALES_DETAILS QI ON Q.voucherNo = QI.voucherNo ORDER BY Q.voucherNo, seq
VOUCHER_004=SELECT Q.voucherNo AS voucherNo, voucherDate, etc1, etc2, memo, discount, dealKind, dealName, dealCode, dealClassCode, dealClassName, dealStaffSei, dealStaffName, dealStaffKeisyo, dealStaffBusyo, dealTel, dealPostCode1, dealPostCode2, dealAddr1, dealAddr2, shimebiMonthly, kessaiMonthly, shimebiKessai, dealDivision, tax, calc, calcHasu, staffSei, staffName, staffCode, staffBusyo, seq, itemName, itemCode, itemKikaku, itemCount, itemUnit, itemUnitPrice, itemMemo, itemPurchasePrice FROM T_PURCHASE Q LEFT JOIN V_PURCHASE_DEAL QD ON Q.voucherNo = QD.voucherNo LEFT JOIN V_PURCHASE_DETAILS QI ON Q.voucherNo = QI.voucherNo ORDER BY Q.voucherNo, seq
VOUCHER_005=SELECT B.voucherNo AS voucherNo, voucherDate, memo, discount, dealKind, dealName, dealCode, dealClassCode, dealClassName, dealStaffSei, dealStaffName, dealStaffKeisyo, dealStaffBusyo, dealTel, dealPostCode1, dealPostCode2, dealAddr1, dealAddr2, shimebiMonthly, kessaiMonthly, shimebiKessai, dealDivision, priceDivision, staffSei, staffName, staffCode, staffBusyo, seq, salesNo, salesSeq, salesDate, itemName, itemCode, itemKikaku, itemCount, itemUnit, itemUnitPrice, itemMemo, itemPurchasePrice FROM T_BILL B LEFT JOIN V_BILL_DEAL BD ON B.voucherNo = BD.voucherNo LEFT JOIN T_BILL_DETAILS BI ON B.voucherNo = BI.voucherNo ORDER BY B.voucherNo, seq

VOUCHER_00601=SELECT itemCode FROM t_quotation_details WHERE itemCode IN
VOUCHER_00602=SELECT itemCode FROM t_order_details WHERE itemCode IN
VOUCHER_00603=SELECT itemCode FROM t_sales s, t_sales_details sd WHERE s.voucherNo=sd.voucherNo AND itemCode IN
VOUCHER_00604=SELECT itemCode FROM t_purchase p, t_purchase_details pd WHERE p.voucherNo=pd.voucherNo AND itemCode IN
VOUCHER_00605=ORDER BY itemCode

#VOUCHER_CUSTOMER
VOUCHER_CUSTOMER_001=SELECT M.code AS dealCode, M.name AS dealName, M.classCode AS dealClassCode, M_CLASS.name AS dealClassName, M.customerStaffSei AS dealStaffSei, M.customerStaffName AS dealStaffName, M.keisyo AS dealStaffKeisyo, M.busyo AS dealStaffBusyo, M.tel AS dealTel, M.postCode1 AS dealPostCode1, M.postCode2 AS dealPostCode2, M.addr1 AS dealAddr1, M.addr2 AS dealAddr2, M.shimebiMonthly, M.kessaiMonthly, M.shimebiKessai, M.dealDivision, M.salePriceDivision AS priceDivision, M.staffCode, STAFF.sei AS staffSei, STAFF.name AS staffName, STAFF.busyo AS staffBusyo FROM (M_CUSTOMER M LEFT JOIN M_CUSTOMER_CLASS M_CLASS ON M.CLASSCODE = M_CLASS.CODE) LEFT JOIN M_STAFF STAFF ON M.STAFFCODE = STAFF.CODE WHERE M.code LIKE ? ORDER BY M.CODE

#VOUCHER_SUPPLIER
VOUCHER_SUPPLIER_001=SELECT M.code AS dealCode, M.name AS dealName, M.classCode AS dealClassCode, M_CLASS.name AS dealClassName, M.supplierStaffSei AS dealStaffSei, M.supplierStaffName AS dealStaffName, M.keisyo AS dealStaffKeisyo, M.busyo AS dealStaffBusyo, M.tel AS dealTel, M.postCode1 AS dealPostCode1, M.postCode2 AS dealPostCode2, M.addr1 AS dealAddr1, M.addr2 AS dealAddr2, M.shimebiMonthly, M.kessaiMonthly, M.shimebiKessai, M.dealDivision, M.tax, M.calc, M.calcHasu, M.staffCode, STAFF.sei AS staffSei, STAFF.name AS staffName, STAFF.busyo AS staffBusyo FROM (M_SUPPLIER M LEFT JOIN M_SUPPLIER_CLASS M_CLASS ON M.CLASSCODE = M_CLASS.CODE) LEFT JOIN M_STAFF STAFF ON M.STAFFCODE = STAFF.CODE WHERE M.code LIKE ? ORDER BY M.CODE

#VOUCHER_ITEM
VOUCHER_ITEM_001=SELECT code AS itemCode, name AS itemName, kikaku AS itemKikaku, unit AS itemUnit, standardPrice AS itemUnitPrice1, sellingPrice2 AS itemUnitPrice2, sellingPrice3 AS itemUnitPrice3, sellingPrice4 AS itemUnitPrice4, sellingPrice5 AS itemUnitPrice5, price AS itemPurchasePrice FROM M_ITEM WHERE code LIKE ? ORDER BY code

#BILL_CUSTOMER
BILL_CUSTOMER_001=SELECT SD.dealCode, SD.dealName, SD.dealClassCode, SD.dealClassName, SD.dealAddr1, SD.dealAddr2, SD.dealPostCode1, SD.dealPostCode2, SD.dealTel, SD.dealStaffSei, SD.dealStaffName, SD.dealStaffKeisyo, SD.dealStaffBusyo, SD.dealDivision, SD.priceDivision, SD.shimebiMonthly, SD.shimebiKessai, SD.kessaiMonthly, SD.staffCode, SD.staffSei, SD.staffName, SD.staffBusyo, S.voucherNo AS salesNo, SI.seq AS salesSeq, S.voucherDate AS salesDate, SI.itemCode, SI.itemName, SI.itemKikaku, SI.itemCount, SI.itemUnit, SI.itemUnitPrice, SI.itemMemo, SI.itemPurchasePrice FROM T_SALES S LEFT JOIN V_SALES_DEAL SD ON S.voucherNo = SD.voucherNo LEFT JOIN V_SALES_DETAILS SI ON S.voucherNo = SI.voucherNo LEFT JOIN M_CUSTOMER M ON SD.dealCode = M.code WHERE SD.dealDivision = 1 AND SD.dealCode LIKE ? ORDER BY SD.dealCode, S.voucherNo, seq


########################################
# BOOK
########################################
#BOOK_ITEM_COMMON
BOOK_ITEM_COMMON_001=ORDER BY I.kana
BOOK_ITEM_COMMON_002=ORDER BY I.code
BOOK_ITEM_COMMON_003=ORDER BY IC.kana
BOOK_ITEM_COMMON_004=ORDER BY IC.code
BOOK_ITEM_COMMON_005=ORDER BY voucherDate
BOOK_ITEM_COMMON_006=ORDER BY voucherNo

#BOOK_ITEM_STOCK
BOOK_ITEM_STOCK_00101=SELECT IC.name AS className,I.kana,I.name,stock,properStock FROM M_ITEM I LEFT JOIN M_ITEM_CLASS IC ON I.classCode = IC.code
BOOK_ITEM_STOCK_00102=SELECT IC.name AS className,I.kana,I.name,stock,price FROM M_ITEM I LEFT JOIN M_ITEM_CLASS IC ON I.classCode = IC.code
BOOK_ITEM_STOCK_00103=SELECT IC.name AS className,I.kana,I.name,stock,properStock FROM M_ITEM I LEFT JOIN M_ITEM_CLASS IC ON I.classCode = IC.code WHERE I.code=?
BOOK_ITEM_STOCK_00104=SELECT IC.name AS className,I.kana,I.name,stock,price FROM M_ITEM I LEFT JOIN M_ITEM_CLASS IC ON I.classCode = IC.code WHERE I.code=?
BOOK_ITEM_STOCK_00105=SELECT IC.name AS className,I.kana,I.name,stock,properStock FROM M_ITEM I JOIN M_ITEM_CLASS IC ON I.classCode = IC.code WHERE I.classCode=?
BOOK_ITEM_STOCK_00106=SELECT IC.name AS className,I.kana,I.name,stock,price FROM M_ITEM I JOIN M_ITEM_CLASS IC ON I.classCode = IC.code WHERE I.classCode=?
BOOK_ITEM_STOCK_00107=SELECT IC.name AS className,I.kana,I.name,stock,properStock FROM M_ITEM I JOIN M_ITEM_CLASS IC ON I.classCode = IC.code WHERE I.code=? AND I.classCode=?
BOOK_ITEM_STOCK_00108=SELECT IC.name AS className,I.kana,I.name,stock,price FROM M_ITEM I JOIN M_ITEM_CLASS IC ON I.classCode = IC.code WHERE I.code=? AND I.classCode=?
BOOK_ITEM_STOCK_00109=ORDER BY I.kana
BOOK_ITEM_STOCK_00110=ORDER BY I.kana DESC
BOOK_ITEM_STOCK_00111=ORDER BY I.code
BOOK_ITEM_STOCK_00112=ORDER BY I.code DESC
BOOK_ITEM_STOCK_00113=ORDER BY IC.kana
BOOK_ITEM_STOCK_00114=ORDER BY IC.kana DESC
BOOK_ITEM_STOCK_00115=ORDER BY IC.code
BOOK_ITEM_STOCK_00116=ORDER BY IC.code DESC

#BOOK_STOCK_TRANSITION
BOOK_STOCK_TRANSITION_00101=SELECT I.code, I.kana, I.name, I.classCode, IC.name as className, kisyuStock + kicyuStockUpDown + IFNULL(V_APR.count,0) as aprCount, kisyuStock + kicyuStockUpDown + IFNULL(V_APR.count,0) + IFNULL(V_MAY.count,0) as mayCount, kisyuStock + kicyuStockUpDown + IFNULL(V_APR.count,0) + IFNULL(V_MAY.count,0) + IFNULL(V_JUN.count,0) as junCount, kisyuStock + kicyuStockUpDown + IFNULL(V_APR.count,0) + IFNULL(V_MAY.count,0) + IFNULL(V_JUN.count,0) + IFNULL(V_JLY.count,0) as jlyCount, kisyuStock + kicyuStockUpDown + IFNULL(V_APR.count,0) + IFNULL(V_MAY.count,0) + IFNULL(V_JUN.count,0) + IFNULL(V_JLY.count,0) + IFNULL(V_AUG.count,0) as augCount, kisyuStock + kicyuStockUpDown + IFNULL(V_APR.count,0) + IFNULL(V_MAY.count,0) + IFNULL(V_JUN.count,0) + IFNULL(V_JLY.count,0) + IFNULL(V_AUG.count,0) + IFNULL(V_SEP.count,0) as sepCount, kisyuStock + kicyuStockUpDown + IFNULL(V_APR.count,0) + IFNULL(V_MAY.count,0) + IFNULL(V_JUN.count,0) + IFNULL(V_JLY.count,0) + IFNULL(V_AUG.count,0) + IFNULL(V_SEP.count,0) + IFNULL(V_OCT.count,0) as octCount, kisyuStock + kicyuStockUpDown + IFNULL(V_APR.count,0) + IFNULL(V_MAY.count,0) + IFNULL(V_JUN.count,0) + IFNULL(V_JLY.count,0) + IFNULL(V_AUG.count,0) + IFNULL(V_SEP.count,0) + IFNULL(V_OCT.count,0) + IFNULL(V_NOV.count,0) as novCount, kisyuStock + kicyuStockUpDown + IFNULL(V_APR.count,0) + IFNULL(V_MAY.count,0) + IFNULL(V_JUN.count,0) + IFNULL(V_JLY.count,0) + IFNULL(V_AUG.count,0) + IFNULL(V_SEP.count,0) + IFNULL(V_OCT.count,0) + IFNULL(V_NOV.count,0) + IFNULL(V_DEC.count,0) as decCount, kisyuStock + kicyuStockUpDown + IFNULL(V_APR.count,0) + IFNULL(V_MAY.count,0) + IFNULL(V_JUN.count,0) + IFNULL(V_JLY.count,0) + IFNULL(V_AUG.count,0) + IFNULL(V_SEP.count,0) + IFNULL(V_OCT.count,0) + IFNULL(V_NOV.count,0) + IFNULL(V_DEC.count,0) + IFNULL(V_JAN.count,0) as janCount, kisyuStock + kicyuStockUpDown + IFNULL(V_APR.count,0) + IFNULL(V_MAY.count,0) + IFNULL(V_JUN.count,0) + IFNULL(V_JLY.count,0) + IFNULL(V_AUG.count,0) + IFNULL(V_SEP.count,0) + IFNULL(V_OCT.count,0) + IFNULL(V_NOV.count,0) + IFNULL(V_DEC.count,0) + IFNULL(V_JAN.count,0) + IFNULL(V_FEB.count,0) as febCount, kisyuStock + kicyuStockUpDown + IFNULL(V_APR.count,0) + IFNULL(V_MAY.count,0) + IFNULL(V_JUN.count,0) + IFNULL(V_JLY.count,0) + IFNULL(V_AUG.count,0) + IFNULL(V_SEP.count,0) + IFNULL(V_OCT.count,0) + IFNULL(V_NOV.count,0) + IFNULL(V_DEC.count,0) + IFNULL(V_JAN.count,0) + IFNULL(V_FEB.count,0) + IFNULL(V_MAR.count,0) as marCount FROM M_ITEM I LEFT JOIN M_ITEM_CLASS IC ON I.classCode = IC.code LEFT JOIN ( (SELECT itemCode, DATE_FORMAT(S.voucherDate,'%Y%m%d') AS voucherDate, -SUM(SD.itemCount) AS count FROM T_SALES S, T_SALES_DETAILS SD WHERE S.voucherNo = SD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120302 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120401 GROUP BY itemCode, voucherDate) UNION (SELECT itemCode, DATE_FORMAT(P.voucherDate,'%Y%m%d') AS voucherDate, SUM(PD.itemCount) AS count FROM T_PURCHASE P, T_PURCHASE_DETAILS PD WHERE P.voucherNo = PD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120302 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120401 GROUP BY itemCode, voucherDate)) V_APR ON I.code = V_APR.itemCode LEFT JOIN ( (SELECT itemCode, DATE_FORMAT(S.voucherDate,'%Y%m%d') AS voucherDate, -SUM(SD.itemCount) AS count FROM T_SALES S, T_SALES_DETAILS SD WHERE S.voucherNo = SD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120402 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120501 GROUP BY itemCode, voucherDate) UNION (SELECT itemCode, DATE_FORMAT(P.voucherDate,'%Y%m%d') AS voucherDate, SUM(PD.itemCount) AS count FROM T_PURCHASE P, T_PURCHASE_DETAILS PD WHERE P.voucherNo = PD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120402 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120501 GROUP BY itemCode, voucherDate)) V_MAY ON I.code = V_MAY.itemCode LEFT JOIN ( (SELECT itemCode, DATE_FORMAT(S.voucherDate,'%Y%m%d') AS voucherDate, -SUM(SD.itemCount) AS count FROM T_SALES S, T_SALES_DETAILS SD WHERE S.voucherNo = SD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120502 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120601 GROUP BY itemCode, voucherDate) UNION (SELECT itemCode, DATE_FORMAT(P.voucherDate,'%Y%m%d') AS voucherDate, SUM(PD.itemCount) AS count FROM T_PURCHASE P, T_PURCHASE_DETAILS PD WHERE P.voucherNo = PD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120502 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120601 GROUP BY itemCode, voucherDate)) V_JUN ON I.code = V_JUN.itemCode LEFT JOIN ( (SELECT itemCode, DATE_FORMAT(S.voucherDate,'%Y%m%d') AS voucherDate, -SUM(SD.itemCount) AS count FROM T_SALES S, T_SALES_DETAILS SD WHERE S.voucherNo = SD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120602 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120701 GROUP BY itemCode, voucherDate) UNION (SELECT itemCode, DATE_FORMAT(P.voucherDate,'%Y%m%d') AS voucherDate, SUM(PD.itemCount) AS count FROM T_PURCHASE P, T_PURCHASE_DETAILS PD WHERE P.voucherNo = PD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120602 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120701 GROUP BY itemCode, voucherDate)) V_JLY ON I.code = V_JLY.itemCode LEFT JOIN ( (SELECT itemCode, DATE_FORMAT(S.voucherDate,'%Y%m%d') AS voucherDate, -SUM(SD.itemCount) AS count FROM T_SALES S, T_SALES_DETAILS SD WHERE S.voucherNo = SD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120702 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120801 GROUP BY itemCode, voucherDate) UNION (SELECT itemCode, DATE_FORMAT(P.voucherDate,'%Y%m%d') AS voucherDate, SUM(PD.itemCount) AS count FROM T_PURCHASE P, T_PURCHASE_DETAILS PD WHERE P.voucherNo = PD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120702 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120801 GROUP BY itemCode, voucherDate)) V_AUG ON I.code = V_AUG.itemCode LEFT JOIN ( (SELECT itemCode, DATE_FORMAT(S.voucherDate,'%Y%m%d') AS voucherDate, -SUM(SD.itemCount) AS count FROM T_SALES S, T_SALES_DETAILS SD WHERE S.voucherNo = SD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120802 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120901 GROUP BY itemCode, voucherDate) UNION (SELECT itemCode, DATE_FORMAT(P.voucherDate,'%Y%m%d') AS voucherDate, SUM(PD.itemCount) AS count FROM T_PURCHASE P, T_PURCHASE_DETAILS PD WHERE P.voucherNo = PD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120802 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120901 GROUP BY itemCode, voucherDate)) V_SEP ON I.code = V_SEP.itemCode LEFT JOIN ( (SELECT itemCode, DATE_FORMAT(S.voucherDate,'%Y%m%d') AS voucherDate, -SUM(SD.itemCount) AS count FROM T_SALES S, T_SALES_DETAILS SD WHERE S.voucherNo = SD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120902 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121001 GROUP BY itemCode, voucherDate) UNION (SELECT itemCode, DATE_FORMAT(P.voucherDate,'%Y%m%d') AS voucherDate, SUM(PD.itemCount) AS count FROM T_PURCHASE P, T_PURCHASE_DETAILS PD WHERE P.voucherNo = PD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120902 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121001 GROUP BY itemCode, voucherDate)) V_OCT ON I.code = V_OCT.itemCode LEFT JOIN ( (SELECT itemCode, DATE_FORMAT(S.voucherDate,'%Y%m%d') AS voucherDate, -SUM(SD.itemCount) AS count FROM T_SALES S, T_SALES_DETAILS SD WHERE S.voucherNo = SD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20121002 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121101 GROUP BY itemCode, voucherDate) UNION (SELECT itemCode, DATE_FORMAT(P.voucherDate,'%Y%m%d') AS voucherDate, SUM(PD.itemCount) AS count FROM T_PURCHASE P, T_PURCHASE_DETAILS PD WHERE P.voucherNo = PD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20121002 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121101 GROUP BY itemCode, voucherDate)) V_NOV ON I.code = V_NOV.itemCode LEFT JOIN ( (SELECT itemCode, DATE_FORMAT(S.voucherDate,'%Y%m%d') AS voucherDate, -SUM(SD.itemCount) AS count FROM T_SALES S, T_SALES_DETAILS SD WHERE S.voucherNo = SD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20121102 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121201 GROUP BY itemCode, voucherDate) UNION (SELECT itemCode, DATE_FORMAT(P.voucherDate,'%Y%m%d') AS voucherDate, SUM(PD.itemCount) AS count FROM T_PURCHASE P, T_PURCHASE_DETAILS PD WHERE P.voucherNo = PD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20121102 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121201 GROUP BY itemCode, voucherDate)) V_DEC ON I.code = V_DEC.itemCode LEFT JOIN ( (SELECT itemCode, DATE_FORMAT(S.voucherDate,'%Y%m%d') AS voucherDate, -SUM(SD.itemCount) AS count FROM T_SALES S, T_SALES_DETAILS SD WHERE S.voucherNo = SD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20121202 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20130101 GROUP BY itemCode, voucherDate) UNION (SELECT itemCode, DATE_FORMAT(P.voucherDate,'%Y%m%d') AS voucherDate, SUM(PD.itemCount) AS count FROM T_PURCHASE P, T_PURCHASE_DETAILS PD WHERE P.voucherNo = PD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20121202 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20130101 GROUP BY itemCode, voucherDate)) V_JAN ON I.code = V_JAN.itemCode LEFT JOIN ( (SELECT itemCode, DATE_FORMAT(S.voucherDate,'%Y%m%d') AS voucherDate, -SUM(SD.itemCount) AS count FROM T_SALES S, T_SALES_DETAILS SD WHERE S.voucherNo = SD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20130102 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20130201 GROUP BY itemCode, voucherDate) UNION (SELECT itemCode, DATE_FORMAT(P.voucherDate,'%Y%m%d') AS voucherDate, SUM(PD.itemCount) AS count FROM T_PURCHASE P, T_PURCHASE_DETAILS PD WHERE P.voucherNo = PD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20130102 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20130201 GROUP BY itemCode, voucherDate)) V_FEB ON I.code = V_FEB.itemCode LEFT JOIN ( (SELECT itemCode, DATE_FORMAT(S.voucherDate,'%Y%m%d') AS voucherDate, -SUM(SD.itemCount) AS count FROM T_SALES S, T_SALES_DETAILS SD WHERE S.voucherNo = SD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20130202 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20130302 GROUP BY itemCode, voucherDate) UNION (SELECT itemCode, DATE_FORMAT(P.voucherDate,'%Y%m%d') AS voucherDate, SUM(PD.itemCount) AS count FROM T_PURCHASE P, T_PURCHASE_DETAILS PD WHERE P.voucherNo = PD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20130202 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20130302 GROUP BY itemCode, voucherDate)) V_MAR ON I.code = V_MAR.itemCode
BOOK_STOCK_TRANSITION_00102=SELECT I.code, I.kana, I.name, I.classCode, IC.name as className, I.price * (kisyuStock + kicyuStockUpDown + IFNULL(V_APR.count,0)) as aprPrice, I.price * (kisyuStock + kicyuStockUpDown + IFNULL(V_APR.count,0) + IFNULL(V_MAY.count,0)) as mayPrice, I.price * (kisyuStock + kicyuStockUpDown + IFNULL(V_APR.count,0) + IFNULL(V_MAY.count,0) + IFNULL(V_JUN.count,0)) as junPrice, I.price * (kisyuStock + kicyuStockUpDown + IFNULL(V_APR.count,0) + IFNULL(V_MAY.count,0) + IFNULL(V_JUN.count,0) + IFNULL(V_JLY.count,0)) as jlyPrice, I.price * (kisyuStock + kicyuStockUpDown + IFNULL(V_APR.count,0) + IFNULL(V_MAY.count,0) + IFNULL(V_JUN.count,0) + IFNULL(V_JLY.count,0) + IFNULL(V_AUG.count,0)) as augPrice, I.price * (kisyuStock + kicyuStockUpDown + IFNULL(V_APR.count,0) + IFNULL(V_MAY.count,0) + IFNULL(V_JUN.count,0) + IFNULL(V_JLY.count,0) + IFNULL(V_AUG.count,0) + IFNULL(V_SEP.count,0)) as sepPrice, I.price * (kisyuStock + kicyuStockUpDown + IFNULL(V_APR.count,0) + IFNULL(V_MAY.count,0) + IFNULL(V_JUN.count,0) + IFNULL(V_JLY.count,0) + IFNULL(V_AUG.count,0) + IFNULL(V_SEP.count,0) + IFNULL(V_OCT.count,0)) as octPrice, I.price * (kisyuStock + kicyuStockUpDown + IFNULL(V_APR.count,0) + IFNULL(V_MAY.count,0) + IFNULL(V_JUN.count,0) + IFNULL(V_JLY.count,0) + IFNULL(V_AUG.count,0) + IFNULL(V_SEP.count,0) + IFNULL(V_OCT.count,0) + IFNULL(V_NOV.count,0)) as novPrice, I.price * (kisyuStock + kicyuStockUpDown + IFNULL(V_APR.count,0) + IFNULL(V_MAY.count,0) + IFNULL(V_JUN.count,0) + IFNULL(V_JLY.count,0) + IFNULL(V_AUG.count,0) + IFNULL(V_SEP.count,0) + IFNULL(V_OCT.count,0) + IFNULL(V_NOV.count,0) + IFNULL(V_DEC.count,0)) as decPrice, I.price * (kisyuStock + kicyuStockUpDown + IFNULL(V_APR.count,0) + IFNULL(V_MAY.count,0) + IFNULL(V_JUN.count,0) + IFNULL(V_JLY.count,0) + IFNULL(V_AUG.count,0) + IFNULL(V_SEP.count,0) + IFNULL(V_OCT.count,0) + IFNULL(V_NOV.count,0) + IFNULL(V_DEC.count,0) + IFNULL(V_JAN.count,0)) as janPrice, I.price * (kisyuStock + kicyuStockUpDown + IFNULL(V_APR.count,0) + IFNULL(V_MAY.count,0) + IFNULL(V_JUN.count,0) + IFNULL(V_JLY.count,0) + IFNULL(V_AUG.count,0) + IFNULL(V_SEP.count,0) + IFNULL(V_OCT.count,0) + IFNULL(V_NOV.count,0) + IFNULL(V_DEC.count,0) + IFNULL(V_JAN.count,0) + IFNULL(V_FEB.count,0)) as febPrice, I.price * (kisyuStock + kicyuStockUpDown + IFNULL(V_APR.count,0) + IFNULL(V_MAY.count,0) + IFNULL(V_JUN.count,0) + IFNULL(V_JLY.count,0) + IFNULL(V_AUG.count,0) + IFNULL(V_SEP.count,0) + IFNULL(V_OCT.count,0) + IFNULL(V_NOV.count,0) + IFNULL(V_DEC.count,0) + IFNULL(V_JAN.count,0) + IFNULL(V_FEB.count,0) + IFNULL(V_MAR.count,0)) as marPrice FROM M_ITEM I LEFT JOIN M_ITEM_CLASS IC ON I.classCode = IC.code LEFT JOIN ( (SELECT itemCode, DATE_FORMAT(S.voucherDate,'%Y%m%d') AS voucherDate, -SUM(SD.itemCount) AS count FROM T_SALES S, T_SALES_DETAILS SD WHERE S.voucherNo = SD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120302 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120401 GROUP BY itemCode, voucherDate) UNION (SELECT itemCode, DATE_FORMAT(P.voucherDate,'%Y%m%d') AS voucherDate, SUM(PD.itemCount) AS count FROM T_PURCHASE P, T_PURCHASE_DETAILS PD WHERE P.voucherNo = PD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120302 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120401 GROUP BY itemCode, voucherDate)) V_APR ON I.code = V_APR.itemCode LEFT JOIN ( (SELECT itemCode, DATE_FORMAT(S.voucherDate,'%Y%m%d') AS voucherDate, -SUM(SD.itemCount) AS count FROM T_SALES S, T_SALES_DETAILS SD WHERE S.voucherNo = SD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120402 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120501 GROUP BY itemCode, voucherDate) UNION (SELECT itemCode, DATE_FORMAT(P.voucherDate,'%Y%m%d') AS voucherDate, SUM(PD.itemCount) AS count FROM T_PURCHASE P, T_PURCHASE_DETAILS PD WHERE P.voucherNo = PD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120402 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120501 GROUP BY itemCode, voucherDate)) V_MAY ON I.code = V_MAY.itemCode LEFT JOIN ( (SELECT itemCode, DATE_FORMAT(S.voucherDate,'%Y%m%d') AS voucherDate, -SUM(SD.itemCount) AS count FROM T_SALES S, T_SALES_DETAILS SD WHERE S.voucherNo = SD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120502 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120601 GROUP BY itemCode, voucherDate) UNION (SELECT itemCode, DATE_FORMAT(P.voucherDate,'%Y%m%d') AS voucherDate, SUM(PD.itemCount) AS count FROM T_PURCHASE P, T_PURCHASE_DETAILS PD WHERE P.voucherNo = PD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120502 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120601 GROUP BY itemCode, voucherDate)) V_JUN ON I.code = V_JUN.itemCode LEFT JOIN ( (SELECT itemCode, DATE_FORMAT(S.voucherDate,'%Y%m%d') AS voucherDate, -SUM(SD.itemCount) AS count FROM T_SALES S, T_SALES_DETAILS SD WHERE S.voucherNo = SD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120602 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120701 GROUP BY itemCode, voucherDate) UNION (SELECT itemCode, DATE_FORMAT(P.voucherDate,'%Y%m%d') AS voucherDate, SUM(PD.itemCount) AS count FROM T_PURCHASE P, T_PURCHASE_DETAILS PD WHERE P.voucherNo = PD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120602 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120701 GROUP BY itemCode, voucherDate)) V_JLY ON I.code = V_JLY.itemCode LEFT JOIN ( (SELECT itemCode, DATE_FORMAT(S.voucherDate,'%Y%m%d') AS voucherDate, -SUM(SD.itemCount) AS count FROM T_SALES S, T_SALES_DETAILS SD WHERE S.voucherNo = SD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120702 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120801 GROUP BY itemCode, voucherDate) UNION (SELECT itemCode, DATE_FORMAT(P.voucherDate,'%Y%m%d') AS voucherDate, SUM(PD.itemCount) AS count FROM T_PURCHASE P, T_PURCHASE_DETAILS PD WHERE P.voucherNo = PD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120702 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120801 GROUP BY itemCode, voucherDate)) V_AUG ON I.code = V_AUG.itemCode LEFT JOIN ( (SELECT itemCode, DATE_FORMAT(S.voucherDate,'%Y%m%d') AS voucherDate, -SUM(SD.itemCount) AS count FROM T_SALES S, T_SALES_DETAILS SD WHERE S.voucherNo = SD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120802 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120901 GROUP BY itemCode, voucherDate) UNION (SELECT itemCode, DATE_FORMAT(P.voucherDate,'%Y%m%d') AS voucherDate, SUM(PD.itemCount) AS count FROM T_PURCHASE P, T_PURCHASE_DETAILS PD WHERE P.voucherNo = PD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120802 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120901 GROUP BY itemCode, voucherDate)) V_SEP ON I.code = V_SEP.itemCode LEFT JOIN ( (SELECT itemCode, DATE_FORMAT(S.voucherDate,'%Y%m%d') AS voucherDate, -SUM(SD.itemCount) AS count FROM T_SALES S, T_SALES_DETAILS SD WHERE S.voucherNo = SD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120902 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121001 GROUP BY itemCode, voucherDate) UNION (SELECT itemCode, DATE_FORMAT(P.voucherDate,'%Y%m%d') AS voucherDate, SUM(PD.itemCount) AS count FROM T_PURCHASE P, T_PURCHASE_DETAILS PD WHERE P.voucherNo = PD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120902 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121001 GROUP BY itemCode, voucherDate)) V_OCT ON I.code = V_OCT.itemCode LEFT JOIN ( (SELECT itemCode, DATE_FORMAT(S.voucherDate,'%Y%m%d') AS voucherDate, -SUM(SD.itemCount) AS count FROM T_SALES S, T_SALES_DETAILS SD WHERE S.voucherNo = SD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20121002 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121101 GROUP BY itemCode, voucherDate) UNION (SELECT itemCode, DATE_FORMAT(P.voucherDate,'%Y%m%d') AS voucherDate, SUM(PD.itemCount) AS count FROM T_PURCHASE P, T_PURCHASE_DETAILS PD WHERE P.voucherNo = PD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20121002 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121101 GROUP BY itemCode, voucherDate)) V_NOV ON I.code = V_NOV.itemCode LEFT JOIN ( (SELECT itemCode, DATE_FORMAT(S.voucherDate,'%Y%m%d') AS voucherDate, -SUM(SD.itemCount) AS count FROM T_SALES S, T_SALES_DETAILS SD WHERE S.voucherNo = SD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20121102 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121201 GROUP BY itemCode, voucherDate) UNION (SELECT itemCode, DATE_FORMAT(P.voucherDate,'%Y%m%d') AS voucherDate, SUM(PD.itemCount) AS count FROM T_PURCHASE P, T_PURCHASE_DETAILS PD WHERE P.voucherNo = PD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20121102 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121201 GROUP BY itemCode, voucherDate)) V_DEC ON I.code = V_DEC.itemCode LEFT JOIN ( (SELECT itemCode, DATE_FORMAT(S.voucherDate,'%Y%m%d') AS voucherDate, -SUM(SD.itemCount) AS count FROM T_SALES S, T_SALES_DETAILS SD WHERE S.voucherNo = SD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20121202 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20130101 GROUP BY itemCode, voucherDate) UNION (SELECT itemCode, DATE_FORMAT(P.voucherDate,'%Y%m%d') AS voucherDate, SUM(PD.itemCount) AS count FROM T_PURCHASE P, T_PURCHASE_DETAILS PD WHERE P.voucherNo = PD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20121202 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20130101 GROUP BY itemCode, voucherDate)) V_JAN ON I.code = V_JAN.itemCode LEFT JOIN ( (SELECT itemCode, DATE_FORMAT(S.voucherDate,'%Y%m%d') AS voucherDate, -SUM(SD.itemCount) AS count FROM T_SALES S, T_SALES_DETAILS SD WHERE S.voucherNo = SD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20130102 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20130201 GROUP BY itemCode, voucherDate) UNION (SELECT itemCode, DATE_FORMAT(P.voucherDate,'%Y%m%d') AS voucherDate, SUM(PD.itemCount) AS count FROM T_PURCHASE P, T_PURCHASE_DETAILS PD WHERE P.voucherNo = PD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20130102 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20130201 GROUP BY itemCode, voucherDate)) V_FEB ON I.code = V_FEB.itemCode LEFT JOIN ( (SELECT itemCode, DATE_FORMAT(S.voucherDate,'%Y%m%d') AS voucherDate, -SUM(SD.itemCount) AS count FROM T_SALES S, T_SALES_DETAILS SD WHERE S.voucherNo = SD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20130202 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20130302 GROUP BY itemCode, voucherDate) UNION (SELECT itemCode, DATE_FORMAT(P.voucherDate,'%Y%m%d') AS voucherDate, SUM(PD.itemCount) AS count FROM T_PURCHASE P, T_PURCHASE_DETAILS PD WHERE P.voucherNo = PD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20130202 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20130302 GROUP BY itemCode, voucherDate)) V_MAR ON I.code = V_MAR.itemCode

#BOOK_SHIP_SUM
BOOK_SHIP_SUM_00101=SELECT I.code, I.name, I.kana, I.classCode, IC.name AS className, IFNULL(SUM(S.itemCount),0) as sumCount FROM M_ITEM I LEFT JOIN M_ITEM_CLASS IC ON I.classCode = IC.code LEFT JOIN (SELECT itemCode, itemCount FROM T_SALES, T_SALES_DETAILS WHERE T_SALES.voucherNo = T_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120103 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121103) S ON I.code = S.itemCode GROUP BY code
BOOK_SHIP_SUM_00102=SELECT I.code, I.name, I.kana, I.classCode, IC.name AS className, IFNULL(SUM(S.price),0) as sumPrice FROM M_ITEM I LEFT JOIN M_ITEM_CLASS IC ON I.classCode = IC.code LEFT JOIN (SELECT itemCode, itemCount * itemUnitPrice AS price FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120102 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121231) S ON I.code = S.itemCode GROUP BY code
BOOK_SHIP_SUM_00103=SELECT I.code, I.kana, I.name, I.classCode, IC.name as className, IFNULL(V_APR.count,0) + IFNULL(V_MAY.count,0) + IFNULL(V_JUN.count,0) + IFNULL(V_JLY.count,0) + IFNULL(V_AUG.count,0) + IFNULL(V_SEP.count,0) + IFNULL(V_OCT.count,0) + IFNULL(V_NOV.count,0) + IFNULL(V_DEC.count,0) + IFNULL(V_JAN.count,0) + IFNULL(V_FEB.count,0) + IFNULL(V_MAR.count,0) as sumCount, IFNULL(V_APR.count,0) as aprCount, IFNULL(V_MAY.count,0) as mayCount, IFNULL(V_JUN.count,0) as junCount, IFNULL(V_JLY.count,0) as jlyCount, IFNULL(V_AUG.count,0) as augCount, IFNULL(V_SEP.count,0) as sepCount, IFNULL(V_OCT.count,0) as octCount, IFNULL(V_NOV.count,0) as novCount, IFNULL(V_DEC.count,0) as decCount, IFNULL(V_JAN.count,0) as janCount, IFNULL(V_FEB.count,0) as febCount, IFNULL(V_MAR.count,0) as marCount FROM M_ITEM I LEFT JOIN M_ITEM_CLASS IC ON I.classCode = IC.code LEFT JOIN (SELECT itemCode, DATE_FORMAT(S.voucherDate,'%Y%m%d') AS voucherDate, SUM(SD.itemCount) AS count FROM T_SALES S, T_SALES_DETAILS SD WHERE S.voucherNo = SD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120302 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120401 GROUP BY itemCode, voucherDate) V_APR ON I.code = V_APR.itemCode LEFT JOIN (SELECT itemCode, DATE_FORMAT(S.voucherDate,'%Y%m%d') AS voucherDate, SUM(SD.itemCount) AS count FROM T_SALES S, T_SALES_DETAILS SD WHERE S.voucherNo = SD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120402 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120501 GROUP BY itemCode, voucherDate) V_MAY ON I.code = V_MAY.itemCode LEFT JOIN (SELECT itemCode, DATE_FORMAT(S.voucherDate,'%Y%m%d') AS voucherDate, SUM(SD.itemCount) AS count FROM T_SALES S, T_SALES_DETAILS SD WHERE S.voucherNo = SD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120502 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120601 GROUP BY itemCode, voucherDate) V_JUN ON I.code = V_JUN.itemCode LEFT JOIN (SELECT itemCode, DATE_FORMAT(S.voucherDate,'%Y%m%d') AS voucherDate, SUM(SD.itemCount) AS count FROM T_SALES S, T_SALES_DETAILS SD WHERE S.voucherNo = SD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120602 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120701 GROUP BY itemCode, voucherDate) V_JLY ON I.code = V_JLY.itemCode LEFT JOIN (SELECT itemCode, DATE_FORMAT(S.voucherDate,'%Y%m%d') AS voucherDate, SUM(SD.itemCount) AS count FROM T_SALES S, T_SALES_DETAILS SD WHERE S.voucherNo = SD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120702 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120801 GROUP BY itemCode, voucherDate) V_AUG ON I.code = V_AUG.itemCode LEFT JOIN (SELECT itemCode, DATE_FORMAT(S.voucherDate,'%Y%m%d') AS voucherDate, SUM(SD.itemCount) AS count FROM T_SALES S, T_SALES_DETAILS SD WHERE S.voucherNo = SD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120802 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120901 GROUP BY itemCode, voucherDate) V_SEP ON I.code = V_SEP.itemCode LEFT JOIN (SELECT itemCode, DATE_FORMAT(S.voucherDate,'%Y%m%d') AS voucherDate, SUM(SD.itemCount) AS count FROM T_SALES S, T_SALES_DETAILS SD WHERE S.voucherNo = SD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120902 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121001 GROUP BY itemCode, voucherDate) V_OCT ON I.code = V_OCT.itemCode LEFT JOIN (SELECT itemCode, DATE_FORMAT(S.voucherDate,'%Y%m%d') AS voucherDate, SUM(SD.itemCount) AS count FROM T_SALES S, T_SALES_DETAILS SD WHERE S.voucherNo = SD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20121002 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121101 GROUP BY itemCode, voucherDate) V_NOV ON I.code = V_NOV.itemCode LEFT JOIN (SELECT itemCode, DATE_FORMAT(S.voucherDate,'%Y%m%d') AS voucherDate, SUM(SD.itemCount) AS count FROM T_SALES S, T_SALES_DETAILS SD WHERE S.voucherNo = SD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20121102 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121201 GROUP BY itemCode, voucherDate) V_DEC ON I.code = V_DEC.itemCode LEFT JOIN (SELECT itemCode, DATE_FORMAT(S.voucherDate,'%Y%m%d') AS voucherDate, SUM(SD.itemCount) AS count FROM T_SALES S, T_SALES_DETAILS SD WHERE S.voucherNo = SD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20121202 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20130101 GROUP BY itemCode, voucherDate) V_JAN ON I.code = V_JAN.itemCode LEFT JOIN (SELECT itemCode, DATE_FORMAT(S.voucherDate,'%Y%m%d') AS voucherDate, SUM(SD.itemCount) AS count FROM T_SALES S, T_SALES_DETAILS SD WHERE S.voucherNo = SD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20130102 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20130201 GROUP BY itemCode, voucherDate) V_FEB ON I.code = V_FEB.itemCode LEFT JOIN (SELECT itemCode, DATE_FORMAT(S.voucherDate,'%Y%m%d') AS voucherDate, SUM(SD.itemCount) AS count FROM T_SALES S, T_SALES_DETAILS SD WHERE S.voucherNo = SD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20130202 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20130301 GROUP BY itemCode, voucherDate) V_MAR ON I.code = V_MAR.itemCode
BOOK_SHIP_SUM_00104=SELECT I.code, I.kana, I.name, I.classCode, IC.name as className, IFNULL(V_APR.itemPrice,0) + IFNULL(V_MAY.itemPrice,0) + IFNULL(V_JUN.itemPrice,0) + IFNULL(V_JLY.itemPrice,0) + IFNULL(V_AUG.itemPrice,0) + IFNULL(V_SEP.itemPrice,0) + IFNULL(V_OCT.itemPrice,0) + IFNULL(V_NOV.itemPrice,0) + IFNULL(V_DEC.itemPrice,0) + IFNULL(V_JAN.itemPrice,0) + IFNULL(V_FEB.itemPrice,0) + IFNULL(V_MAR.itemPrice,0) as sumPrice, IFNULL(V_APR.itemPrice,0) as aprPrice, IFNULL(V_MAY.itemPrice,0) as mayPrice, IFNULL(V_JUN.itemPrice,0) as junPrice, IFNULL(V_JLY.itemPrice,0) as jlyPrice, IFNULL(V_AUG.itemPrice,0) as augPrice, IFNULL(V_SEP.itemPrice,0) as sepPrice, IFNULL(V_OCT.itemPrice,0) as octPrice, IFNULL(V_NOV.itemPrice,0) as novPrice, IFNULL(V_DEC.itemPrice,0) as decPrice, IFNULL(V_JAN.itemPrice,0) as janPrice, IFNULL(V_FEB.itemPrice,0) as febPrice, IFNULL(V_MAR.itemPrice,0) as marPrice FROM M_ITEM I LEFT JOIN M_ITEM_CLASS IC ON I.classCode = IC.code LEFT JOIN (SELECT itemCode, SUM(itemCount * itemUnitPrice) as itemPrice FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120302 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120401 GROUP BY itemCode, voucherDate) V_APR ON I.code = V_APR.itemCode LEFT JOIN (SELECT itemCode, SUM(itemCount * itemUnitPrice) as itemPrice FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120402 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120501 GROUP BY itemCode, voucherDate) V_MAY ON I.code = V_MAY.itemCode LEFT JOIN (SELECT itemCode, SUM(itemCount * itemUnitPrice) as itemPrice FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120502 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120601 GROUP BY itemCode, voucherDate) V_JUN ON I.code = V_JUN.itemCode LEFT JOIN (SELECT itemCode, SUM(itemCount * itemUnitPrice) as itemPrice FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120602 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120701 GROUP BY itemCode, voucherDate) V_JLY ON I.code = V_JLY.itemCode LEFT JOIN (SELECT itemCode, SUM(itemCount * itemUnitPrice) as itemPrice FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120702 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120801 GROUP BY itemCode, voucherDate) V_AUG ON I.code = V_AUG.itemCode LEFT JOIN (SELECT itemCode, SUM(itemCount * itemUnitPrice) as itemPrice FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120802 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120901 GROUP BY itemCode, voucherDate) V_SEP ON I.code = V_SEP.itemCode LEFT JOIN (SELECT itemCode, SUM(itemCount * itemUnitPrice) as itemPrice FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120902 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121001 GROUP BY itemCode, voucherDate) V_OCT ON I.code = V_OCT.itemCode LEFT JOIN (SELECT itemCode, SUM(itemCount * itemUnitPrice) as itemPrice FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20121002 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121101 GROUP BY itemCode, voucherDate) V_NOV ON I.code = V_NOV.itemCode LEFT JOIN (SELECT itemCode, SUM(itemCount * itemUnitPrice) as itemPrice FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20121102 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121201 GROUP BY itemCode, voucherDate) V_DEC ON I.code = V_DEC.itemCode LEFT JOIN (SELECT itemCode, SUM(itemCount * itemUnitPrice) as itemPrice FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20121202 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20130101 GROUP BY itemCode, voucherDate) V_JAN ON I.code = V_JAN.itemCode LEFT JOIN (SELECT itemCode, SUM(itemCount * itemUnitPrice) as itemPrice FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20130102 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20130201 GROUP BY itemCode, voucherDate) V_FEB ON I.code = V_FEB.itemCode LEFT JOIN (SELECT itemCode, SUM(itemCount * itemUnitPrice) as itemPrice FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20130202 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20130301 GROUP BY itemCode, voucherDate) V_MAR ON I.code = V_MAR.itemCode

#BOOK_STORAGE_SUM
BOOK_STORAGE_SUM_00101=SELECT I.code, I.name, I.kana, I.classCode, IC.name AS className, IFNULL(SUM(P.itemCount),0) as sumCount FROM M_ITEM I LEFT JOIN M_ITEM_CLASS IC ON I.classCode = IC.code LEFT JOIN (SELECT itemCode, itemCount FROM T_PURCHASE, T_PURCHASE_DETAILS WHERE T_PURCHASE.voucherNo = T_PURCHASE_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120102 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121231) P ON I.code = P.itemCode GROUP BY code
BOOK_STORAGE_SUM_00102=SELECT I.code, I.name, I.kana, I.classCode, IC.name AS className, IFNULL(SUM(P.itemPurchasePrice),0) as sumPrice FROM M_ITEM I LEFT JOIN M_ITEM_CLASS IC ON I.classCode = IC.code LEFT JOIN (SELECT itemCode, itemCount * itemPurchasePrice AS itemPurchasePrice FROM T_PURCHASE, V_PURCHASE_DETAILS WHERE T_PURCHASE.voucherNo = V_PURCHASE_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120102 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121231) P ON I.code = P.itemCode GROUP BY code
BOOK_STORAGE_SUM_00103=SELECT I.code, I.kana, I.name, I.classCode, IC.name as className, IFNULL(V_APR.count,0) + IFNULL(V_MAY.count,0) + IFNULL(V_JUN.count,0) + IFNULL(V_JLY.count,0) + IFNULL(V_AUG.count,0) + IFNULL(V_SEP.count,0) + IFNULL(V_OCT.count,0) + IFNULL(V_NOV.count,0) + IFNULL(V_DEC.count,0) + IFNULL(V_JAN.count,0) + IFNULL(V_FEB.count,0) + IFNULL(V_MAR.count,0) as sumCount, IFNULL(V_APR.count,0) as aprCount, IFNULL(V_MAY.count,0) as mayCount, IFNULL(V_JUN.count,0) as junCount, IFNULL(V_JLY.count,0) as jlyCount, IFNULL(V_AUG.count,0) as augCount, IFNULL(V_SEP.count,0) as sepCount, IFNULL(V_OCT.count,0) as octCount, IFNULL(V_NOV.count,0) as novCount, IFNULL(V_DEC.count,0) as decCount, IFNULL(V_JAN.count,0) as janCount, IFNULL(V_FEB.count,0) as febCount, IFNULL(V_MAR.count,0) as marCount FROM M_ITEM I LEFT JOIN M_ITEM_CLASS IC ON I.classCode = IC.code LEFT JOIN (SELECT itemCode, DATE_FORMAT(P.voucherDate,'%Y%m%d') AS voucherDate, SUM(PD.itemCount) AS count FROM T_PURCHASE P, T_PURCHASE_DETAILS PD WHERE P.voucherNo = PD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120302 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120401 GROUP BY itemCode, voucherDate) V_APR ON I.code = V_APR.itemCode LEFT JOIN (SELECT itemCode, DATE_FORMAT(P.voucherDate,'%Y%m%d') AS voucherDate, SUM(PD.itemCount) AS count FROM T_PURCHASE P, T_PURCHASE_DETAILS PD WHERE P.voucherNo = PD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120402 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120501 GROUP BY itemCode, voucherDate) V_MAY ON I.code = V_MAY.itemCode LEFT JOIN (SELECT itemCode, DATE_FORMAT(P.voucherDate,'%Y%m%d') AS voucherDate, SUM(PD.itemCount) AS count FROM T_PURCHASE P, T_PURCHASE_DETAILS PD WHERE P.voucherNo = PD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120502 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120601 GROUP BY itemCode, voucherDate) V_JUN ON I.code = V_JUN.itemCode LEFT JOIN (SELECT itemCode, DATE_FORMAT(P.voucherDate,'%Y%m%d') AS voucherDate, SUM(PD.itemCount) AS count FROM T_PURCHASE P, T_PURCHASE_DETAILS PD WHERE P.voucherNo = PD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120602 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120701 GROUP BY itemCode, voucherDate) V_JLY ON I.code = V_JLY.itemCode LEFT JOIN (SELECT itemCode, DATE_FORMAT(P.voucherDate,'%Y%m%d') AS voucherDate, SUM(PD.itemCount) AS count FROM T_PURCHASE P, T_PURCHASE_DETAILS PD WHERE P.voucherNo = PD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120702 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120801 GROUP BY itemCode, voucherDate) V_AUG ON I.code = V_AUG.itemCode LEFT JOIN (SELECT itemCode, DATE_FORMAT(P.voucherDate,'%Y%m%d') AS voucherDate, SUM(PD.itemCount) AS count FROM T_PURCHASE P, T_PURCHASE_DETAILS PD WHERE P.voucherNo = PD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120802 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120901 GROUP BY itemCode, voucherDate) V_SEP ON I.code = V_SEP.itemCode LEFT JOIN (SELECT itemCode, DATE_FORMAT(P.voucherDate,'%Y%m%d') AS voucherDate, SUM(PD.itemCount) AS count FROM T_PURCHASE P, T_PURCHASE_DETAILS PD WHERE P.voucherNo = PD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120902 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121001 GROUP BY itemCode, voucherDate) V_OCT ON I.code = V_OCT.itemCode LEFT JOIN (SELECT itemCode, DATE_FORMAT(P.voucherDate,'%Y%m%d') AS voucherDate, SUM(PD.itemCount) AS count FROM T_PURCHASE P, T_PURCHASE_DETAILS PD WHERE P.voucherNo = PD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20121002 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121101 GROUP BY itemCode, voucherDate) V_NOV ON I.code = V_NOV.itemCode LEFT JOIN (SELECT itemCode, DATE_FORMAT(P.voucherDate,'%Y%m%d') AS voucherDate, SUM(PD.itemCount) AS count FROM T_PURCHASE P, T_PURCHASE_DETAILS PD WHERE P.voucherNo = PD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20121102 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121201 GROUP BY itemCode, voucherDate) V_DEC ON I.code = V_DEC.itemCode LEFT JOIN (SELECT itemCode, DATE_FORMAT(P.voucherDate,'%Y%m%d') AS voucherDate, SUM(PD.itemCount) AS count FROM T_PURCHASE P, T_PURCHASE_DETAILS PD WHERE P.voucherNo = PD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20121202 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20130101 GROUP BY itemCode, voucherDate) V_JAN ON I.code = V_JAN.itemCode LEFT JOIN (SELECT itemCode, DATE_FORMAT(P.voucherDate,'%Y%m%d') AS voucherDate, SUM(PD.itemCount) AS count FROM T_PURCHASE P, T_PURCHASE_DETAILS PD WHERE P.voucherNo = PD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20130102 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20130201 GROUP BY itemCode, voucherDate) V_FEB ON I.code = V_FEB.itemCode LEFT JOIN (SELECT itemCode, DATE_FORMAT(P.voucherDate,'%Y%m%d') AS voucherDate, SUM(PD.itemCount) AS count FROM T_PURCHASE P, T_PURCHASE_DETAILS PD WHERE P.voucherNo = PD.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20130202 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20130301 GROUP BY itemCode, voucherDate) V_MAR ON I.code = V_MAR.itemCode
BOOK_STORAGE_SUM_00104=SELECT I.code, I.kana, I.name, I.classCode, IC.name as className, IFNULL(V_APR.itemPurchasePrice,0) + IFNULL(V_MAY.itemPurchasePrice,0) + IFNULL(V_JUN.itemPurchasePrice,0) + IFNULL(V_JLY.itemPurchasePrice,0) + IFNULL(V_AUG.itemPurchasePrice,0) + IFNULL(V_SEP.itemPurchasePrice,0) + IFNULL(V_OCT.itemPurchasePrice,0) + IFNULL(V_NOV.itemPurchasePrice,0) + IFNULL(V_DEC.itemPurchasePrice,0) + IFNULL(V_JAN.itemPurchasePrice,0) + IFNULL(V_FEB.itemPurchasePrice,0) + IFNULL(V_MAR.itemPurchasePrice,0) as sumPrice, IFNULL(V_APR.itemPurchasePrice,0) as aprPrice, IFNULL(V_MAY.itemPurchasePrice,0) as mayPrice, IFNULL(V_JUN.itemPurchasePrice,0) as junPrice, IFNULL(V_JLY.itemPurchasePrice,0) as jlyPrice, IFNULL(V_AUG.itemPurchasePrice,0) as augPrice, IFNULL(V_SEP.itemPurchasePrice,0) as sepPrice, IFNULL(V_OCT.itemPurchasePrice,0) as octPrice, IFNULL(V_NOV.itemPurchasePrice,0) as novPrice, IFNULL(V_DEC.itemPurchasePrice,0) as decPrice, IFNULL(V_JAN.itemPurchasePrice,0) as janPrice, IFNULL(V_FEB.itemPurchasePrice,0) as febPrice, IFNULL(V_MAR.itemPurchasePrice,0) as marPrice FROM M_ITEM I LEFT JOIN M_ITEM_CLASS IC ON I.classCode = IC.code LEFT JOIN (SELECT itemCode, SUM(itemCount * itemPurchasePrice) as itemPurchasePrice FROM T_PURCHASE, V_PURCHASE_DETAILS WHERE T_PURCHASE.voucherNo = V_PURCHASE_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120302 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120401 GROUP BY itemCode, voucherDate) V_APR ON I.code = V_APR.itemCode LEFT JOIN (SELECT itemCode, SUM(itemCount * itemPurchasePrice) as itemPurchasePrice FROM T_PURCHASE, V_PURCHASE_DETAILS WHERE T_PURCHASE.voucherNo = V_PURCHASE_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120402 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120501 GROUP BY itemCode, voucherDate) V_MAY ON I.code = V_MAY.itemCode LEFT JOIN (SELECT itemCode, SUM(itemCount * itemPurchasePrice) as itemPurchasePrice FROM T_PURCHASE, V_PURCHASE_DETAILS WHERE T_PURCHASE.voucherNo = V_PURCHASE_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120502 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120601 GROUP BY itemCode, voucherDate) V_JUN ON I.code = V_JUN.itemCode LEFT JOIN (SELECT itemCode, SUM(itemCount * itemPurchasePrice) as itemPurchasePrice FROM T_PURCHASE, V_PURCHASE_DETAILS WHERE T_PURCHASE.voucherNo = V_PURCHASE_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120602 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120701 GROUP BY itemCode, voucherDate) V_JLY ON I.code = V_JLY.itemCode LEFT JOIN (SELECT itemCode, SUM(itemCount * itemPurchasePrice) as itemPurchasePrice FROM T_PURCHASE, V_PURCHASE_DETAILS WHERE T_PURCHASE.voucherNo = V_PURCHASE_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120702 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120801 GROUP BY itemCode, voucherDate) V_AUG ON I.code = V_AUG.itemCode LEFT JOIN (SELECT itemCode, SUM(itemCount * itemPurchasePrice) as itemPurchasePrice FROM T_PURCHASE, V_PURCHASE_DETAILS WHERE T_PURCHASE.voucherNo = V_PURCHASE_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120802 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120901 GROUP BY itemCode, voucherDate) V_SEP ON I.code = V_SEP.itemCode LEFT JOIN (SELECT itemCode, SUM(itemCount * itemPurchasePrice) as itemPurchasePrice FROM T_PURCHASE, V_PURCHASE_DETAILS WHERE T_PURCHASE.voucherNo = V_PURCHASE_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120902 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121001 GROUP BY itemCode, voucherDate) V_OCT ON I.code = V_OCT.itemCode LEFT JOIN (SELECT itemCode, SUM(itemCount * itemPurchasePrice) as itemPurchasePrice FROM T_PURCHASE, V_PURCHASE_DETAILS WHERE T_PURCHASE.voucherNo = V_PURCHASE_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20121002 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121101 GROUP BY itemCode, voucherDate) V_NOV ON I.code = V_NOV.itemCode LEFT JOIN (SELECT itemCode, SUM(itemCount * itemPurchasePrice) as itemPurchasePrice FROM T_PURCHASE, V_PURCHASE_DETAILS WHERE T_PURCHASE.voucherNo = V_PURCHASE_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20121102 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121201 GROUP BY itemCode, voucherDate) V_DEC ON I.code = V_DEC.itemCode LEFT JOIN (SELECT itemCode, SUM(itemCount * itemPurchasePrice) as itemPurchasePrice FROM T_PURCHASE, V_PURCHASE_DETAILS WHERE T_PURCHASE.voucherNo = V_PURCHASE_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20121202 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20130101 GROUP BY itemCode, voucherDate) V_JAN ON I.code = V_JAN.itemCode LEFT JOIN (SELECT itemCode, SUM(itemCount * itemPurchasePrice) as itemPurchasePrice FROM T_PURCHASE, V_PURCHASE_DETAILS WHERE T_PURCHASE.voucherNo = V_PURCHASE_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20130102 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20130201 GROUP BY itemCode, voucherDate) V_FEB ON I.code = V_FEB.itemCode LEFT JOIN (SELECT itemCode, SUM(itemCount * itemPurchasePrice) as itemPurchasePrice FROM T_PURCHASE, V_PURCHASE_DETAILS WHERE T_PURCHASE.voucherNo = V_PURCHASE_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20130202 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20130301 GROUP BY itemCode, voucherDate) V_MAR ON I.code = V_MAR.itemCode

#BOOK_SHIP_BOOK
BOOK_SHIP_BOOK_00101=SELECT S.voucherNo, DATE_FORMAT(voucherDate,'%Y/%m/%d') as voucherDate, itemCode as code, itemName as name, I.kana, I.classCode, IC.name as className, itemCount as count FROM M_ITEM I LEFT JOIN M_ITEM_CLASS IC ON I.classCode = IC.code JOIN V_SALES_DETAILS SD ON I.code = SD.itemCode JOIN T_SALES S ON S.voucherNo = SD.voucherNo

#BOOK_STORAGE_BOOK
BOOK_STORAGE_BOOK_00101=SELECT P.voucherNo, DATE_FORMAT(voucherDate,'%Y/%m/%d') as voucherDate, itemCode as code, itemName as name, I.kana, I.classCode, IC.name as className, itemCount as count FROM M_ITEM I LEFT JOIN M_ITEM_CLASS IC ON I.classCode = IC.code JOIN V_PURCHASE_DETAILS PD ON I.code = PD.itemCode JOIN T_PURCHASE P ON P.voucherNo = PD.voucherNo

#BOOK_SALES_PRICE_AVE
BOOK_SALES_PRICE_AVE_00101=SELECT I.code, I.name, I.kana, I.classCode, IC.name AS className, IFNULL(AVG(S.itemPrice),0) as avePrice FROM M_ITEM I LEFT JOIN M_ITEM_CLASS IC ON I.classCode = IC.code LEFT JOIN (SELECT itemCode, itemCount * itemUnitPrice AS itemPrice FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120102 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121231) S ON I.code = S.itemCode GROUP BY code
BOOK_SALES_PRICE_AVE_00102=SELECT I.code, I.kana, I.name, I.classCode, IC.name as className, IFNULL(V_APR.itemPrice,0) as aprPrice, IFNULL(V_MAY.itemPrice,0) as mayPrice, IFNULL(V_JUN.itemPrice,0) as junPrice, IFNULL(V_JLY.itemPrice,0) as jlyPrice, IFNULL(V_AUG.itemPrice,0) as augPrice, IFNULL(V_SEP.itemPrice,0) as sepPrice, IFNULL(V_OCT.itemPrice,0) as octPrice, IFNULL(V_NOV.itemPrice,0) as novPrice, IFNULL(V_DEC.itemPrice,0) as decPrice, IFNULL(V_JAN.itemPrice,0) as janPrice, IFNULL(V_FEB.itemPrice,0) as febPrice, IFNULL(V_MAR.itemPrice,0) as marPrice FROM M_ITEM I LEFT JOIN M_ITEM_CLASS IC ON I.classCode = IC.code LEFT JOIN (SELECT itemCode, AVG(itemCount * itemUnitPrice) as itemPrice FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120302 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120401 GROUP BY itemCode, voucherDate) V_APR ON I.code = V_APR.itemCode LEFT JOIN (SELECT itemCode, AVG(itemCount * itemUnitPrice) as itemPrice FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120402 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120501 GROUP BY itemCode, voucherDate) V_MAY ON I.code = V_MAY.itemCode LEFT JOIN (SELECT itemCode, AVG(itemCount * itemUnitPrice) as itemPrice FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120502 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120601 GROUP BY itemCode, voucherDate) V_JUN ON I.code = V_JUN.itemCode LEFT JOIN (SELECT itemCode, AVG(itemCount * itemUnitPrice) as itemPrice FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120602 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120701 GROUP BY itemCode, voucherDate) V_JLY ON I.code = V_JLY.itemCode LEFT JOIN (SELECT itemCode, AVG(itemCount * itemUnitPrice) as itemPrice FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120702 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120801 GROUP BY itemCode, voucherDate) V_AUG ON I.code = V_AUG.itemCode LEFT JOIN (SELECT itemCode, AVG(itemCount * itemUnitPrice) as itemPrice FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120802 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120901 GROUP BY itemCode, voucherDate) V_SEP ON I.code = V_SEP.itemCode LEFT JOIN (SELECT itemCode, AVG(itemCount * itemUnitPrice) as itemPrice FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120902 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121001 GROUP BY itemCode, voucherDate) V_OCT ON I.code = V_OCT.itemCode LEFT JOIN (SELECT itemCode, AVG(itemCount * itemUnitPrice) as itemPrice FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20121002 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121101 GROUP BY itemCode, voucherDate) V_NOV ON I.code = V_NOV.itemCode LEFT JOIN (SELECT itemCode, AVG(itemCount * itemUnitPrice) as itemPrice FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20121102 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121201 GROUP BY itemCode, voucherDate) V_DEC ON I.code = V_DEC.itemCode LEFT JOIN (SELECT itemCode, AVG(itemCount * itemUnitPrice) as itemPrice FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20121202 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20130101 GROUP BY itemCode, voucherDate) V_JAN ON I.code = V_JAN.itemCode LEFT JOIN (SELECT itemCode, AVG(itemCount * itemUnitPrice) as itemPrice FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20130102 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20130201 GROUP BY itemCode, voucherDate) V_FEB ON I.code = V_FEB.itemCode LEFT JOIN (SELECT itemCode, AVG(itemCount * itemUnitPrice) as itemPrice FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20130202 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20130301 GROUP BY itemCode, voucherDate) V_MAR ON I.code = V_MAR.itemCode

#BOOK_PURCHASE_PRICE_AVE
BOOK_PURCHASE_PRICE_AVE_00101=SELECT I.code, I.name, I.kana, I.classCode, IC.name AS className, IFNULL(AVG(P.itemPurchasePrice),0) as avePrice FROM M_ITEM I LEFT JOIN M_ITEM_CLASS IC ON I.classCode = IC.code LEFT JOIN (SELECT itemCode, itemCount * itemPurchasePrice AS itemPurchasePrice FROM T_PURCHASE, V_PURCHASE_DETAILS WHERE T_PURCHASE.voucherNo = V_PURCHASE_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120102 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121231) P ON I.code = P.itemCode GROUP BY code
BOOK_PURCHASE_PRICE_AVE_00102=SELECT I.code, I.kana, I.name, I.classCode, IC.name as className, IFNULL(V_APR.itemPurchasePrice,0) as aprPrice, IFNULL(V_MAY.itemPurchasePrice,0) as mayPrice, IFNULL(V_JUN.itemPurchasePrice,0) as junPrice, IFNULL(V_JLY.itemPurchasePrice,0) as jlyPrice, IFNULL(V_AUG.itemPurchasePrice,0) as augPrice, IFNULL(V_SEP.itemPurchasePrice,0) as sepPrice, IFNULL(V_OCT.itemPurchasePrice,0) as octPrice, IFNULL(V_NOV.itemPurchasePrice,0) as novPrice, IFNULL(V_DEC.itemPurchasePrice,0) as decPrice, IFNULL(V_JAN.itemPurchasePrice,0) as janPrice, IFNULL(V_FEB.itemPurchasePrice,0) as febPrice, IFNULL(V_MAR.itemPurchasePrice,0) as marPrice FROM M_ITEM I LEFT JOIN M_ITEM_CLASS IC ON I.classCode = IC.code LEFT JOIN (SELECT itemCode, AVG(itemCount * itemPurchasePrice) as itemPurchasePrice FROM T_PURCHASE, V_PURCHASE_DETAILS WHERE T_PURCHASE.voucherNo = V_PURCHASE_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120302 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120401 GROUP BY itemCode, voucherDate) V_APR ON I.code = V_APR.itemCode LEFT JOIN (SELECT itemCode, AVG(itemCount * itemPurchasePrice) as itemPurchasePrice FROM T_PURCHASE, V_PURCHASE_DETAILS WHERE T_PURCHASE.voucherNo = V_PURCHASE_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120402 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120501 GROUP BY itemCode, voucherDate) V_MAY ON I.code = V_MAY.itemCode LEFT JOIN (SELECT itemCode, AVG(itemCount * itemPurchasePrice) as itemPurchasePrice FROM T_PURCHASE, V_PURCHASE_DETAILS WHERE T_PURCHASE.voucherNo = V_PURCHASE_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120502 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120601 GROUP BY itemCode, voucherDate) V_JUN ON I.code = V_JUN.itemCode LEFT JOIN (SELECT itemCode, AVG(itemCount * itemPurchasePrice) as itemPurchasePrice FROM T_PURCHASE, V_PURCHASE_DETAILS WHERE T_PURCHASE.voucherNo = V_PURCHASE_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120602 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120701 GROUP BY itemCode, voucherDate) V_JLY ON I.code = V_JLY.itemCode LEFT JOIN (SELECT itemCode, AVG(itemCount * itemPurchasePrice) as itemPurchasePrice FROM T_PURCHASE, V_PURCHASE_DETAILS WHERE T_PURCHASE.voucherNo = V_PURCHASE_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120702 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120801 GROUP BY itemCode, voucherDate) V_AUG ON I.code = V_AUG.itemCode LEFT JOIN (SELECT itemCode, AVG(itemCount * itemPurchasePrice) as itemPurchasePrice FROM T_PURCHASE, V_PURCHASE_DETAILS WHERE T_PURCHASE.voucherNo = V_PURCHASE_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120802 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120901 GROUP BY itemCode, voucherDate) V_SEP ON I.code = V_SEP.itemCode LEFT JOIN (SELECT itemCode, AVG(itemCount * itemPurchasePrice) as itemPurchasePrice FROM T_PURCHASE, V_PURCHASE_DETAILS WHERE T_PURCHASE.voucherNo = V_PURCHASE_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120902 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121001 GROUP BY itemCode, voucherDate) V_OCT ON I.code = V_OCT.itemCode LEFT JOIN (SELECT itemCode, AVG(itemCount * itemPurchasePrice) as itemPurchasePrice FROM T_PURCHASE, V_PURCHASE_DETAILS WHERE T_PURCHASE.voucherNo = V_PURCHASE_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20121002 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121101 GROUP BY itemCode, voucherDate) V_NOV ON I.code = V_NOV.itemCode LEFT JOIN (SELECT itemCode, AVG(itemCount * itemPurchasePrice) as itemPurchasePrice FROM T_PURCHASE, V_PURCHASE_DETAILS WHERE T_PURCHASE.voucherNo = V_PURCHASE_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20121102 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121201 GROUP BY itemCode, voucherDate) V_DEC ON I.code = V_DEC.itemCode LEFT JOIN (SELECT itemCode, AVG(itemCount * itemPurchasePrice) as itemPurchasePrice FROM T_PURCHASE, V_PURCHASE_DETAILS WHERE T_PURCHASE.voucherNo = V_PURCHASE_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20121202 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20130101 GROUP BY itemCode, voucherDate) V_JAN ON I.code = V_JAN.itemCode LEFT JOIN (SELECT itemCode, AVG(itemCount * itemPurchasePrice) as itemPurchasePrice FROM T_PURCHASE, V_PURCHASE_DETAILS WHERE T_PURCHASE.voucherNo = V_PURCHASE_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20130102 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20130201 GROUP BY itemCode, voucherDate) V_FEB ON I.code = V_FEB.itemCode LEFT JOIN (SELECT itemCode, AVG(itemCount * itemPurchasePrice) as itemPurchasePrice FROM T_PURCHASE, V_PURCHASE_DETAILS WHERE T_PURCHASE.voucherNo = V_PURCHASE_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20130202 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20130301 GROUP BY itemCode, voucherDate) V_MAR ON I.code = V_MAR.itemCode

#BOOK_GROSS
BOOK_GROSS_00101=SELECT I.code, I.name, I.kana, I.classCode, IC.name AS className, IFNULL(SUM(S.itemPrice) - SUM(S.itemPurchasePrice),0) as gross FROM M_ITEM I LEFT JOIN M_ITEM_CLASS IC ON I.classCode = IC.code LEFT JOIN (SELECT itemCode, itemCount * itemPurchasePrice AS itemPurchasePrice, itemCount * itemUnitPrice AS itemPrice FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120102 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121231) S ON I.code = S.itemCode GROUP BY code
BOOK_GROSS_00102=SELECT I.code, I.kana, I.name, I.classCode, IC.name as className, IFNULL(V_APR.itemPrice,0) as aprPrice, IFNULL(V_MAY.itemPrice,0) as mayPrice, IFNULL(V_JUN.itemPrice,0) as junPrice, IFNULL(V_JLY.itemPrice,0) as jlyPrice, IFNULL(V_AUG.itemPrice,0) as augPrice, IFNULL(V_SEP.itemPrice,0) as sepPrice, IFNULL(V_OCT.itemPrice,0) as octPrice, IFNULL(V_NOV.itemPrice,0) as novPrice, IFNULL(V_DEC.itemPrice,0) as decPrice, IFNULL(V_JAN.itemPrice,0) as janPrice, IFNULL(V_FEB.itemPrice,0) as febPrice, IFNULL(V_MAR.itemPrice,0) as marPrice FROM M_ITEM I LEFT JOIN M_ITEM_CLASS IC ON I.classCode = IC.code LEFT JOIN (SELECT itemCode, SUM(itemCount * itemUnitPrice) - SUM(itemCount * itemPurchasePrice) as itemPrice FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120302 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120401 GROUP BY itemCode, voucherDate) V_APR ON I.code = V_APR.itemCode LEFT JOIN (SELECT itemCode, SUM(itemCount * itemUnitPrice) - SUM(itemCount * itemPurchasePrice) as itemPrice FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120402 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120501 GROUP BY itemCode, voucherDate) V_MAY ON I.code = V_MAY.itemCode LEFT JOIN (SELECT itemCode, SUM(itemCount * itemUnitPrice) - SUM(itemCount * itemPurchasePrice) as itemPrice FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120502 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120601 GROUP BY itemCode, voucherDate) V_JUN ON I.code = V_JUN.itemCode LEFT JOIN (SELECT itemCode, SUM(itemCount * itemUnitPrice) - SUM(itemCount * itemPurchasePrice) as itemPrice FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120602 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120701 GROUP BY itemCode, voucherDate) V_JLY ON I.code = V_JLY.itemCode LEFT JOIN (SELECT itemCode, SUM(itemCount * itemUnitPrice) - SUM(itemCount * itemPurchasePrice) as itemPrice FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120702 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120801 GROUP BY itemCode, voucherDate) V_AUG ON I.code = V_AUG.itemCode LEFT JOIN (SELECT itemCode, SUM(itemCount * itemUnitPrice) - SUM(itemCount * itemPurchasePrice) as itemPrice FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120802 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120901 GROUP BY itemCode, voucherDate) V_SEP ON I.code = V_SEP.itemCode LEFT JOIN (SELECT itemCode, SUM(itemCount * itemUnitPrice) - SUM(itemCount * itemPurchasePrice) as itemPrice FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120902 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121001 GROUP BY itemCode, voucherDate) V_OCT ON I.code = V_OCT.itemCode LEFT JOIN (SELECT itemCode, SUM(itemCount * itemUnitPrice) - SUM(itemCount * itemPurchasePrice) as itemPrice FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20121002 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121101 GROUP BY itemCode, voucherDate) V_NOV ON I.code = V_NOV.itemCode LEFT JOIN (SELECT itemCode, SUM(itemCount * itemUnitPrice) - SUM(itemCount * itemPurchasePrice) as itemPrice FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20121102 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121201 GROUP BY itemCode, voucherDate) V_DEC ON I.code = V_DEC.itemCode LEFT JOIN (SELECT itemCode, SUM(itemCount * itemUnitPrice) - SUM(itemCount * itemPurchasePrice) as itemPrice FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20121202 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20130101 GROUP BY itemCode, voucherDate) V_JAN ON I.code = V_JAN.itemCode LEFT JOIN (SELECT itemCode, SUM(itemCount * itemUnitPrice) - SUM(itemCount * itemPurchasePrice) as itemPrice FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20130102 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20130201 GROUP BY itemCode, voucherDate) V_FEB ON I.code = V_FEB.itemCode LEFT JOIN (SELECT itemCode, SUM(itemCount * itemUnitPrice) - SUM(itemCount * itemPurchasePrice) as itemPrice FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20130202 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20130301 GROUP BY itemCode, voucherDate) V_MAR ON I.code = V_MAR.itemCode

#BOOK_PROFIT
BOOK_PROFIT_00101=SELECT I.code, I.name, I.kana, I.classCode, IC.name AS className, IFNULL(ROUND((SUM(S.itemPurchasePrice) / SUM(S.itemPrice) * 100),0) ,0) as profit FROM M_ITEM I LEFT JOIN M_ITEM_CLASS IC ON I.classCode = IC.code LEFT JOIN (SELECT itemCode, itemCount * itemPurchasePrice AS itemPurchasePrice, itemCount * itemUnitPrice AS itemPrice FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120102 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121231) S ON I.code = S.itemCode GROUP BY code
BOOK_PROFIT_00102=SELECT I.code, I.kana, I.name, I.classCode, IC.name as className, IFNULL(V_APR.percent,0) as aprProfit, IFNULL(V_MAY.percent,0) as mayProfit, IFNULL(V_JUN.percent,0) as junProfit, IFNULL(V_JLY.percent,0) as jlyProfit, IFNULL(V_AUG.percent,0) as augProfit, IFNULL(V_SEP.percent,0) as sepProfit, IFNULL(V_OCT.percent,0) as octProfit, IFNULL(V_NOV.percent,0) as novProfit, IFNULL(V_DEC.percent,0) as decProfit, IFNULL(V_JAN.percent,0) as janProfit, IFNULL(V_FEB.percent,0) as febProfit, IFNULL(V_MAR.percent,0) as marProfit FROM M_ITEM I LEFT JOIN M_ITEM_CLASS IC ON I.classCode = IC.code LEFT JOIN (SELECT itemCode, ROUND((SUM(itemCount * itemPurchasePrice) / SUM(itemCount * itemUnitPrice) * 100),0) as percent FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120302 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120401 GROUP BY itemCode, voucherDate) V_APR ON I.code = V_APR.itemCode LEFT JOIN (SELECT itemCode, ROUND((SUM(itemCount * itemPurchasePrice) / SUM(itemCount * itemUnitPrice) * 100),0) as percent FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120402 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120501 GROUP BY itemCode, voucherDate) V_MAY ON I.code = V_MAY.itemCode LEFT JOIN (SELECT itemCode, ROUND((SUM(itemCount * itemPurchasePrice) / SUM(itemCount * itemUnitPrice) * 100),0) as percent FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120502 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120601 GROUP BY itemCode, voucherDate) V_JUN ON I.code = V_JUN.itemCode LEFT JOIN (SELECT itemCode, ROUND((SUM(itemCount * itemPurchasePrice) / SUM(itemCount * itemUnitPrice) * 100),0) as percent FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120602 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120701 GROUP BY itemCode, voucherDate) V_JLY ON I.code = V_JLY.itemCode LEFT JOIN (SELECT itemCode, ROUND((SUM(itemCount * itemPurchasePrice) / SUM(itemCount * itemUnitPrice) * 100),0) as percent FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120702 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120801 GROUP BY itemCode, voucherDate) V_AUG ON I.code = V_AUG.itemCode LEFT JOIN (SELECT itemCode, ROUND((SUM(itemCount * itemPurchasePrice) / SUM(itemCount * itemUnitPrice) * 100),0) as percent FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120802 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120901 GROUP BY itemCode, voucherDate) V_SEP ON I.code = V_SEP.itemCode LEFT JOIN (SELECT itemCode, ROUND((SUM(itemCount * itemPurchasePrice) / SUM(itemCount * itemUnitPrice) * 100),0) as percent FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120902 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121001 GROUP BY itemCode, voucherDate) V_OCT ON I.code = V_OCT.itemCode LEFT JOIN (SELECT itemCode, ROUND((SUM(itemCount * itemPurchasePrice) / SUM(itemCount * itemUnitPrice) * 100),0) as percent FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20121002 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121101 GROUP BY itemCode, voucherDate) V_NOV ON I.code = V_NOV.itemCode LEFT JOIN (SELECT itemCode, ROUND((SUM(itemCount * itemPurchasePrice) / SUM(itemCount * itemUnitPrice) * 100),0) as percent FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20121102 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121201 GROUP BY itemCode, voucherDate) V_DEC ON I.code = V_DEC.itemCode LEFT JOIN (SELECT itemCode, ROUND((SUM(itemCount * itemPurchasePrice) / SUM(itemCount * itemUnitPrice) * 100),0) as percent FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20121202 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20130101 GROUP BY itemCode, voucherDate) V_JAN ON I.code = V_JAN.itemCode LEFT JOIN (SELECT itemCode, ROUND((SUM(itemCount * itemPurchasePrice) / SUM(itemCount * itemUnitPrice) * 100),0) as percent FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20130102 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20130201 GROUP BY itemCode, voucherDate) V_FEB ON I.code = V_FEB.itemCode LEFT JOIN (SELECT itemCode, ROUND((SUM(itemCount * itemPurchasePrice) / SUM(itemCount * itemUnitPrice) * 100),0) as percent FROM T_SALES, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20130202 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20130301 GROUP BY itemCode, voucherDate) V_MAR ON I.code = V_MAR.itemCode

#BOOK_SALES_COMMON
BOOK_SALES_COMMON_001=ORDER BY C.kana
BOOK_SALES_COMMON_002=ORDER BY C.code
BOOK_SALES_COMMON_003=ORDER BY S.voucherDate
BOOK_SALES_COMMON_004=ORDER BY S.voucherNo

#BOOK_SALES_TOTAL
BOOK_SALES_TOTAL_00101=SELECT C.code, C.name, C.kana, IFNULL(SUM(itemCount * itemUnitPrice),0) AS taxExcludedAmount, IFNULL(discount,0) AS discount, IFNULL(SUM(itemCount * itemUnitPrice),0) - IFNULL(SUM(itemCount * itemPurchasePrice),0) AS gross FROM M_CUSTOMER C LEFT JOIN V_SALES_DEAL SD ON C.code = SD.dealCode LEFT JOIN T_SALES S ON S.voucherNo = SD.voucherNo LEFT JOIN V_SALES_DETAILS SI ON S.voucherNo = SI.voucherNo GROUP BY code
BOOK_SALES_TOTAL_00102=SELECT C.code, C.name, C.kana, IFNULL(V_APR.itemPrice,0) as aprPrice, IFNULL(V_MAY.itemPrice,0) as mayPrice, IFNULL(V_JUN.itemPrice,0) as junPrice, IFNULL(V_JLY.itemPrice,0) as jlyPrice, IFNULL(V_AUG.itemPrice,0) as augPrice, IFNULL(V_SEP.itemPrice,0) as sepPrice, IFNULL(V_OCT.itemPrice,0) as octPrice, IFNULL(V_NOV.itemPrice,0) as novPrice, IFNULL(V_DEC.itemPrice,0) as decPrice, IFNULL(V_JAN.itemPrice,0) as janPrice, IFNULL(V_FEB.itemPrice,0) as febPrice, IFNULL(V_MAR.itemPrice,0) as marPrice FROM M_CUSTOMER C LEFT JOIN (SELECT dealCode, SUM(itemCount * itemUnitPrice) as itemPrice FROM T_SALES, T_SALES_DEAL, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND T_SALES.voucherNo = T_SALES_DEAL.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120302 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120401 GROUP BY dealCode, voucherDate) V_APR ON C.code = V_APR.dealCode LEFT JOIN (SELECT dealCode, SUM(itemCount * itemUnitPrice) as itemPrice FROM T_SALES, T_SALES_DEAL, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND T_SALES.voucherNo = T_SALES_DEAL.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120402 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120501 GROUP BY dealCode, voucherDate) V_MAY ON C.code = V_MAY.dealCode LEFT JOIN (SELECT dealCode, SUM(itemCount * itemUnitPrice) as itemPrice FROM T_SALES, T_SALES_DEAL, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND T_SALES.voucherNo = T_SALES_DEAL.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120502 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120601 GROUP BY dealCode, voucherDate) V_JUN ON C.code = V_JUN.dealCode LEFT JOIN (SELECT dealCode, SUM(itemCount * itemUnitPrice) as itemPrice FROM T_SALES, T_SALES_DEAL, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND T_SALES.voucherNo = T_SALES_DEAL.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120602 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120701 GROUP BY dealCode, voucherDate) V_JLY ON C.code = V_JLY.dealCode LEFT JOIN (SELECT dealCode, SUM(itemCount * itemUnitPrice) as itemPrice FROM T_SALES, T_SALES_DEAL, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND T_SALES.voucherNo = T_SALES_DEAL.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120702 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120801 GROUP BY dealCode, voucherDate) V_AUG ON C.code = V_AUG.dealCode LEFT JOIN (SELECT dealCode, SUM(itemCount * itemUnitPrice) as itemPrice FROM T_SALES, T_SALES_DEAL, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND T_SALES.voucherNo = T_SALES_DEAL.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120802 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120901 GROUP BY dealCode, voucherDate) V_SEP ON C.code = V_SEP.dealCode LEFT JOIN (SELECT dealCode, SUM(itemCount * itemUnitPrice) as itemPrice FROM T_SALES, T_SALES_DEAL, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND T_SALES.voucherNo = T_SALES_DEAL.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120902 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121001 GROUP BY dealCode, voucherDate) V_OCT ON C.code = V_OCT.dealCode LEFT JOIN (SELECT dealCode, SUM(itemCount * itemUnitPrice) as itemPrice FROM T_SALES, T_SALES_DEAL, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND T_SALES.voucherNo = T_SALES_DEAL.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20121002 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121101 GROUP BY dealCode, voucherDate) V_NOV ON C.code = V_NOV.dealCode LEFT JOIN (SELECT dealCode, SUM(itemCount * itemUnitPrice) as itemPrice FROM T_SALES, T_SALES_DEAL, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND T_SALES.voucherNo = T_SALES_DEAL.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20121102 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121201 GROUP BY dealCode, voucherDate) V_DEC ON C.code = V_DEC.dealCode LEFT JOIN (SELECT dealCode, SUM(itemCount * itemUnitPrice) as itemPrice FROM T_SALES, T_SALES_DEAL, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND T_SALES.voucherNo = T_SALES_DEAL.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20121202 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20130101 GROUP BY dealCode, voucherDate) V_JAN ON C.code = V_JAN.dealCode LEFT JOIN (SELECT dealCode, SUM(itemCount * itemUnitPrice) as itemPrice FROM T_SALES, T_SALES_DEAL, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND T_SALES.voucherNo = T_SALES_DEAL.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20130102 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20130201 GROUP BY dealCode, voucherDate) V_FEB ON C.code = V_FEB.dealCode LEFT JOIN (SELECT dealCode, SUM(itemCount * itemUnitPrice) as itemPrice FROM T_SALES, T_SALES_DEAL, V_SALES_DETAILS WHERE T_SALES.voucherNo = V_SALES_DETAILS.voucherNo AND T_SALES.voucherNo = T_SALES_DEAL.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20130202 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20130301 GROUP BY dealCode, voucherDate) V_MAR ON C.code = V_MAR.dealCode

#BOOK_SALES_BOOK
BOOK_SALES_BOOK_00101=SELECT DATE_FORMAT(voucherDate,'%Y/%m/%d') as voucherDate, S.voucherNo, dealClassCode as classCode, dealClassName as className, dealCode as code, dealName as name, C.kana, SUM(itemUnitPrice) as sumTaxExcludedPrice, discount, C.dealDivision, staffSei, staffName, IFNULL(SUM(itemUnitPrice),0) - IFNULL(SUM(itemPurchasePrice),0) AS gross FROM T_SALES S, V_SALES_DEAL SD, M_CUSTOMER C, V_SALES_DETAILS SI WHERE S.voucherNo = SD.voucherNo AND S.voucherNo = SI.voucherNo AND SD.dealCode = C.code GROUP BY voucherNo
BOOK_SALES_BOOK_00102=SELECT DATE_FORMAT(voucherDate,'%Y/%m/%d') as voucherDate, S.voucherNo, dealClassCode as classCode, dealClassName as className, dealCode as code, dealName as name, C.kana, SI.itemCode, itemName, I.kana as itemKana, IC.code as itemClassCode, IC.name as itemClassName, itemCount, itemUnitPrice as itemUnitPrice, discount, C.dealDivision, staffSei, staffName, IFNULL(itemUnitPrice,0) - IFNULL(itemPurchasePrice,0) AS gross, itemPurchasePrice FROM T_SALES S, V_SALES_DEAL SD, M_CUSTOMER C, V_SALES_DETAILS SI, M_ITEM I LEFT JOIN M_ITEM_CLASS IC ON I.classCode = IC.code WHERE S.voucherNo = SD.voucherNo AND S.voucherNo = SI.voucherNo AND SD.dealCode = C.code AND SI.itemCode = I.code

#BOOK_URIKAKE_BOOK
BOOK_URIKAKE_BOOK_00101=SELECT DATE_FORMAT(voucherDate,'%Y/%m/%d') as voucherDate, S.voucherNo, dealClassCode as classCode, dealClassName as className, dealCode as code, dealName as name, C.kana, SUM(itemUnitPrice) as sumTaxExcludedPrice, discount, C.dealDivision, staffSei, staffName FROM T_SALES S, V_SALES_DEAL SD, M_CUSTOMER C, V_SALES_DETAILS SI WHERE S.voucherNo = SD.voucherNo AND S.voucherNo = SI.voucherNo AND SD.dealCode = C.code AND C.dealDivision = '1' GROUP BY voucherNo
BOOK_URIKAKE_BOOK_00102=SELECT DATE_FORMAT(voucherDate,'%Y/%m/%d') as voucherDate, S.voucherNo, dealClassCode as classCode, dealClassName as className, dealCode as code, dealName as name, C.kana, SI.itemCode, itemName, I.kana as itemKana, IC.code as itemClassCode, IC.name as itemClassName, itemCount, itemUnitPrice as itemUnitPrice, discount, C.dealDivision, staffSei, staffName FROM T_SALES S, V_SALES_DEAL SD, M_CUSTOMER C, V_SALES_DETAILS SI, M_ITEM I LEFT JOIN M_ITEM_CLASS IC ON I.classCode = IC.code WHERE S.voucherNo = SD.voucherNo AND S.voucherNo = SI.voucherNo AND SD.dealCode = C.code AND SI.itemCode = I.code AND C.dealDivision = '1'

#BOOK_PURCHASE_TOTAL
BOOK_PURCHASE_TOTAL_00101=SELECT S.code, S.name, S.kana, IFNULL(SUM(itemCount * itemPurchasePrice),0) AS taxExcludedAmount, IFNULL(discount,0) AS discount FROM M_SUPPLIER S LEFT JOIN V_PURCHASE_DEAL PD ON S.code = PD.dealCode LEFT JOIN T_PURCHASE P ON P.voucherNo = PD.voucherNo LEFT JOIN V_PURCHASE_DETAILS PI ON P.voucherNo = PI.voucherNo GROUP BY code
BOOK_PURCHASE_TOTAL_00102=SELECT S.code, S.name, S.kana, IFNULL(V_APR.itemPurchasePrice,0) as aprPrice, IFNULL(V_MAY.itemPurchasePrice,0) as mayPrice, IFNULL(V_JUN.itemPurchasePrice,0) as junPrice, IFNULL(V_JLY.itemPurchasePrice,0) as jlyPrice, IFNULL(V_AUG.itemPurchasePrice,0) as augPrice, IFNULL(V_SEP.itemPurchasePrice,0) as sepPrice, IFNULL(V_OCT.itemPurchasePrice,0) as octPrice, IFNULL(V_NOV.itemPurchasePrice,0) as novPrice, IFNULL(V_DEC.itemPurchasePrice,0) as decPrice, IFNULL(V_JAN.itemPurchasePrice,0) as janPrice, IFNULL(V_FEB.itemPurchasePrice,0) as febPrice, IFNULL(V_MAR.itemPurchasePrice,0) as marPrice FROM M_SUPPLIER S LEFT JOIN (SELECT dealCode, SUM(itemCount * itemPurchasePrice) as itemPurchasePrice FROM T_PURCHASE, T_PURCHASE_DEAL, V_PURCHASE_DETAILS WHERE T_PURCHASE.voucherNo = V_PURCHASE_DETAILS.voucherNo AND T_PURCHASE.voucherNo = T_PURCHASE_DEAL.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120302 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120401 GROUP BY dealCode, voucherDate) V_APR ON S.code = V_APR.dealCode LEFT JOIN (SELECT dealCode, SUM(itemCount * itemPurchasePrice) as itemPurchasePrice FROM T_PURCHASE, T_PURCHASE_DEAL, V_PURCHASE_DETAILS WHERE T_PURCHASE.voucherNo = V_PURCHASE_DETAILS.voucherNo AND T_PURCHASE.voucherNo = T_PURCHASE_DEAL.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120402 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120501 GROUP BY dealCode, voucherDate) V_MAY ON S.code = V_MAY.dealCode LEFT JOIN (SELECT dealCode, SUM(itemCount * itemPurchasePrice) as itemPurchasePrice FROM T_PURCHASE, T_PURCHASE_DEAL, V_PURCHASE_DETAILS WHERE T_PURCHASE.voucherNo = V_PURCHASE_DETAILS.voucherNo AND T_PURCHASE.voucherNo = T_PURCHASE_DEAL.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120502 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120601 GROUP BY dealCode, voucherDate) V_JUN ON S.code = V_JUN.dealCode LEFT JOIN (SELECT dealCode, SUM(itemCount * itemPurchasePrice) as itemPurchasePrice FROM T_PURCHASE, T_PURCHASE_DEAL, V_PURCHASE_DETAILS WHERE T_PURCHASE.voucherNo = V_PURCHASE_DETAILS.voucherNo AND T_PURCHASE.voucherNo = T_PURCHASE_DEAL.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120602 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120701 GROUP BY dealCode, voucherDate) V_JLY ON S.code = V_JLY.dealCode LEFT JOIN (SELECT dealCode, SUM(itemCount * itemPurchasePrice) as itemPurchasePrice FROM T_PURCHASE, T_PURCHASE_DEAL, V_PURCHASE_DETAILS WHERE T_PURCHASE.voucherNo = V_PURCHASE_DETAILS.voucherNo AND T_PURCHASE.voucherNo = T_PURCHASE_DEAL.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120702 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120801 GROUP BY dealCode, voucherDate) V_AUG ON S.code = V_AUG.dealCode LEFT JOIN (SELECT dealCode, SUM(itemCount * itemPurchasePrice) as itemPurchasePrice FROM T_PURCHASE, T_PURCHASE_DEAL, V_PURCHASE_DETAILS WHERE T_PURCHASE.voucherNo = V_PURCHASE_DETAILS.voucherNo AND T_PURCHASE.voucherNo = T_PURCHASE_DEAL.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120802 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20120901 GROUP BY dealCode, voucherDate) V_SEP ON S.code = V_SEP.dealCode LEFT JOIN (SELECT dealCode, SUM(itemCount * itemPurchasePrice) as itemPurchasePrice FROM T_PURCHASE, T_PURCHASE_DEAL, V_PURCHASE_DETAILS WHERE T_PURCHASE.voucherNo = V_PURCHASE_DETAILS.voucherNo AND T_PURCHASE.voucherNo = T_PURCHASE_DEAL.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20120902 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121001 GROUP BY dealCode, voucherDate) V_OCT ON S.code = V_OCT.dealCode LEFT JOIN (SELECT dealCode, SUM(itemCount * itemPurchasePrice) as itemPurchasePrice FROM T_PURCHASE, T_PURCHASE_DEAL, V_PURCHASE_DETAILS WHERE T_PURCHASE.voucherNo = V_PURCHASE_DETAILS.voucherNo AND T_PURCHASE.voucherNo = T_PURCHASE_DEAL.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20121002 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121101 GROUP BY dealCode, voucherDate) V_NOV ON S.code = V_NOV.dealCode LEFT JOIN (SELECT dealCode, SUM(itemCount * itemPurchasePrice) as itemPurchasePrice FROM T_PURCHASE, T_PURCHASE_DEAL, V_PURCHASE_DETAILS WHERE T_PURCHASE.voucherNo = V_PURCHASE_DETAILS.voucherNo AND T_PURCHASE.voucherNo = T_PURCHASE_DEAL.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20121102 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20121201 GROUP BY dealCode, voucherDate) V_DEC ON S.code = V_DEC.dealCode LEFT JOIN (SELECT dealCode, SUM(itemCount * itemPurchasePrice) as itemPurchasePrice FROM T_PURCHASE, T_PURCHASE_DEAL, V_PURCHASE_DETAILS WHERE T_PURCHASE.voucherNo = V_PURCHASE_DETAILS.voucherNo AND T_PURCHASE.voucherNo = T_PURCHASE_DEAL.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20121202 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20130101 GROUP BY dealCode, voucherDate) V_JAN ON S.code = V_JAN.dealCode LEFT JOIN (SELECT dealCode, SUM(itemCount * itemPurchasePrice) as itemPurchasePrice FROM T_PURCHASE, T_PURCHASE_DEAL, V_PURCHASE_DETAILS WHERE T_PURCHASE.voucherNo = V_PURCHASE_DETAILS.voucherNo AND T_PURCHASE.voucherNo = T_PURCHASE_DEAL.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20130102 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20130201 GROUP BY dealCode, voucherDate) V_FEB ON S.code = V_FEB.dealCode LEFT JOIN (SELECT dealCode, SUM(itemCount * itemPurchasePrice) as itemPurchasePrice FROM T_PURCHASE, T_PURCHASE_DEAL, V_PURCHASE_DETAILS WHERE T_PURCHASE.voucherNo = V_PURCHASE_DETAILS.voucherNo AND T_PURCHASE.voucherNo = T_PURCHASE_DEAL.voucherNo AND DATE_FORMAT(voucherDate,'%Y%m%d') >= 20130202 AND DATE_FORMAT(voucherDate,'%Y%m%d') <= 20130301 GROUP BY dealCode, voucherDate) V_MAR ON S.code = V_MAR.dealCode

#BOOK_PURCHASE_BOOK
BOOK_PURCHASE_BOOK_00101=SELECT DATE_FORMAT(voucherDate,'%Y/%m/%d') as voucherDate, P.voucherNo, dealClassCode as classCode, dealClassName as className, dealCode as code, dealName as name, S.kana, SUM(itemPurchasePrice) as sumTaxExcludedPrice, discount, S.dealDivision, staffSei, staffName FROM T_PURCHASE P, V_PURCHASE_DEAL PD, M_SUPPLIER S, V_PURCHASE_DETAILS PI WHERE P.voucherNo = PD.voucherNo AND P.voucherNo = PI.voucherNo AND PD.dealCode = S.code GROUP BY voucherNo
BOOK_PURCHASE_BOOK_00102=SELECT DATE_FORMAT(voucherDate,'%Y/%m/%d') as voucherDate, P.voucherNo, dealClassCode as classCode, dealClassName as className, dealCode as code, dealName as name, S.kana, PI.itemCode, itemName, I.kana as itemKana, IC.code as itemClassCode, IC.name as itemClassName, itemCount, itemPurchasePrice, discount, S.dealDivision, staffSei, staffName FROM T_PURCHASE P, V_PURCHASE_DEAL PD, M_SUPPLIER S, V_PURCHASE_DETAILS PI, M_ITEM I LEFT JOIN M_ITEM_CLASS IC ON I.classCode = IC.code WHERE P.voucherNo = PD.voucherNo AND P.voucherNo = PI.voucherNo AND PD.dealCode = S.code AND PI.itemCode = I.code

#BOOK_KAIKAKE_BOOK
BOOK_KAIKAKE_BOOK_00101=SELECT DATE_FORMAT(voucherDate,'%Y/%m/%d') as voucherDate, P.voucherNo, dealClassCode as classCode, dealClassName as className, dealCode as code, dealName as name, S.kana, SUM(itemPurchasePrice) as sumTaxExcludedPrice, discount, S.dealDivision, staffSei, staffName FROM T_PURCHASE P, V_PURCHASE_DEAL PD, M_SUPPLIER S, V_PURCHASE_DETAILS PI WHERE P.voucherNo = PD.voucherNo AND P.voucherNo = PI.voucherNo AND PD.dealCode = S.code AND S.dealDivision = '1' GROUP BY voucherNo
BOOK_KAIKAKE_BOOK_00102=SELECT DATE_FORMAT(voucherDate,'%Y/%m/%d') as voucherDate, P.voucherNo, dealClassCode as classCode, dealClassName as className, dealCode as code, dealName as name, S.kana, PI.itemCode, itemName, I.kana as itemKana, IC.code as itemClassCode, IC.name as itemClassName, itemCount, itemPurchasePrice, discount, S.dealDivision, staffSei, staffName FROM T_PURCHASE P, V_PURCHASE_DEAL PD, M_SUPPLIER S, V_PURCHASE_DETAILS PI, M_ITEM I LEFT JOIN M_ITEM_CLASS IC ON I.classCode = IC.code WHERE P.voucherNo = PD.voucherNo AND P.voucherNo = PI.voucherNo AND PD.dealCode = S.code AND PI.itemCode = I.code AND S.dealDivision = '1'

#BOOK_QUOTATION
BOOK_QUOTATION_00101=SELECT DATE_FORMAT(voucherDate,'%Y/%m/%d') as voucherDate, Q.voucherNo, dealCode as code, dealName as name, staffSei, staffName, SUM(itemCount * itemUnitPrice) AS sumTaxExcludedAmount, discount FROM T_QUOTATION Q, V_QUOTATION_DEAL QD, V_QUOTATION_DETAILS QI WHERE Q.voucherNo = QD.voucherNo AND Q.voucherNo = QI.voucherNo GROUP BY Q.voucherNo

#BOOK_BILL_TOTAL
BOOK_BILL_TOTAL_00101=SELECT DATE_FORMAT(voucherDate,'%Y/%m/%d') as voucherDate, S.voucherNo, dealCode as code, dealName as name, staffSei, staffName, SUM(itemCount * itemUnitPrice) AS sumTaxExcludedAmount, discount FROM T_SALES S, V_SALES_DEAL SD, V_SALES_DETAILS SI WHERE S.voucherNo = SD.voucherNo AND S.voucherNo = SI.voucherNo GROUP BY S.voucherNo

#BOOK_ACKNOWLEDGMENT
BOOK_ACKNOWLEDGMENT_00101=SELECT DATE_FORMAT(receiptDate,'%Y/%m/%d') as receiptDate, receiptNo, DATE_FORMAT(voucherDate,'%Y/%m/%d') as voucherDate, S.voucherNo, dealCode as code, dealName as name, staffSei, staffName, SUM(itemCount * itemUnitPrice) AS sumTaxExcludedAmount, discount FROM T_SALES S, V_SALES_DEAL SD, V_SALES_DETAILS SI WHERE receiptNo IS NOT NULL AND S.voucherNo = SD.voucherNo AND S.voucherNo = SI.voucherNo GROUP BY S.voucherNo

#BOOK_ORDER
BOOK_ORDER_00101=SELECT DATE_FORMAT(voucherDate,'%Y/%m/%d') as voucherDate, P.voucherNo, dealCode as code, dealName as name, staffSei, staffName, SUM(itemCount * itemPurchasePrice) AS sumTaxExcludedAmount, discount FROM T_PURCHASE P, V_PURCHASE_DEAL PD, V_PURCHASE_DETAILS PI WHERE P.voucherNo = PD.voucherNo AND P.voucherNo = PI.voucherNo GROUP BY P.voucherNo

